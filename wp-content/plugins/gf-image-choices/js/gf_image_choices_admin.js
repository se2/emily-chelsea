var imageChoicesAdmin=imageChoicesAdmin||{};!function(e){var i=2;imageChoicesAdmin.extend=(...arguments)=>{let e={},i=!1,t=0;"boolean"==typeof arguments[0]&&(i=arguments[0],t++);let o=function(t){for(let o in t)t.hasOwnProperty(o)&&(i&&"[object Object]"===Object.prototype.toString.call(t[o])?e[o]=imageChoicesAdmin.extend(!0,e[o],t[o]):e[o]=t[o])};for(;t<arguments.length;t++)o(arguments[t]);return e},imageChoicesAdmin.__dialogDefaults={dialogType:"alert",cancelText:"Cancel",confirmText:"Ok",allowCancel:!0,promptLabel:"",promptPlaceholder:"",promptValue:"",title:"",content:"",image:!1,onConfirm:null,onCancel:null},imageChoicesAdmin.closeDialog=e=>{let i=document.getElementById(e);i&&(i.classList.remove("ic-active"),setTimeout((()=>{i.remove()}),300));let t=document.querySelector(`.ic-dialog-bg[data-for="${e}"]`);t&&(t.classList.remove("ic-active"),setTimeout((()=>{t.remove()}),300))},imageChoicesAdmin.dialog=e=>{let i=imageChoicesAdmin.__dialogDefaults,t="object"==typeof e?imageChoicesAdmin.extend(!0,i,e):i;"alert"!==t.dialogType&&"confirm"!==t.dialogType&&"prompt"!==t.dialogType&&(t.dialogType=imageChoicesAdmin.__dialogDefaults.dialogType),"alert"===t.dialogType&&(t.allowCancel=!1);let o=document.querySelectorAll(".ic-dialog").length,a=`ic_dialog_${o}`,c=999900,s=document.createElement("div");s.classList.add("ic-dialog-bg"),s.dataset.for=a,s.style.zIndex=`${c+o}`;let n=t.allowCancel?`<button type="button" class="ic-btn ic-btn-secondary ic-dialog-cancel">${t.cancelText}</button>`:"",m=t.promptLabel?`<label for="${a}_input" class="ic-prompt-input-label">${t.promptLabel}</label>`:"",g="prompt"===t.dialogType?`<div class="ic-prompt-input-wrap">${m}<input type="text" id="${a}_input" class=ic-prompt-input" value="${t.promptValue}" placeholder="${t.promptPlaceholder}"></div>`:"",d=document.createElement("div");d.id=a,d.classList.add("ic-dialog",`ic-dialog-${t.dialogType}`),d.innerHTML=`<div class="ic-dialog-header">${t.title}</div><div class="ic-dialog-body">${t.content}${g}</div><div class="ic-dialog-footer">${n}<button type="button" class="ic-btn ic-dialog-confirm">${t.confirmText}</button></div>`,d.style.zIndex=`${c+o+1}`,document.body.append(s),document.body.append(d),setTimeout((()=>{s.classList.add("ic-active"),d.classList.add("ic-active")}),10),d.querySelector(".ic-dialog-confirm").addEventListener("click",(e=>{e.preventDefault();let i=e.currentTarget.closest(".ic-dialog").id;if("function"==typeof t.onConfirm){let e="prompt"===t.dialogType?document.getElementById(`${i}_input`).value:void 0;t.onConfirm(e)}imageChoicesAdmin.closeDialog(i)})),t.allowCancel&&d.querySelector(".ic-dialog-cancel").addEventListener("click",(e=>{e.preventDefault(),"function"==typeof t.onCancel&&t.onCancel(),imageChoicesAdmin.closeDialog(e.currentTarget.closest(".ic-dialog").id)}))},imageChoicesAdmin.prompt=e=>{let i=imageChoicesAdmin.__dialogDefaults;"object"!=typeof e&&(e={}),e.dialogType="prompt";let t="object"==typeof e?imageChoicesAdmin.extend(!0,i,e):i;imageChoicesAdmin.dialog(t)},imageChoicesAdmin.confirm=e=>{let i=imageChoicesAdmin.__dialogDefaults;"object"!=typeof e&&(e={}),e.dialogType="confirm";let t="object"==typeof e?imageChoicesAdmin.extend(!0,i,e):i;imageChoicesAdmin.dialog(t)},imageChoicesAdmin.alert=e=>{let i=imageChoicesAdmin.__dialogDefaults;"object"!=typeof e&&(e={}),e.dialogType="alert";let t="object"==typeof e?imageChoicesAdmin.extend(!0,i,e):i;imageChoicesAdmin.dialog(t)},imageChoicesAdmin.markupDetect=function(){return void 0!==window.form&&window.form.hasOwnProperty("markupVersion")&&(i=""!==window.form.markupVersion?parseInt(window.form.markupVersion.toString(),10):1),i},imageChoicesAdmin.isLegacyMode=function(){return!(imageChoicesVars.hasOwnProperty("useNewFeatures")&&"true"===imageChoicesVars.useNewFeatures.toString())},imageChoicesAdmin.formHasImageChoicesFields=function(){var i=!1;return e.each(window.form.fields,(function(e,t){if(t.hasOwnProperty("imageChoices_enableImages")&&t.imageChoices_enableImages)return i=!0,!1})),i},imageChoicesAdmin.markup={removeChoicesButton:function(){return'<button class="button image-choices-remove-choices-btn" type="button" onclick="imageChoicesAdmin.removeAllChoices();">'+imageChoicesFieldStrings.removeAllChoices+"</button>"},choicesAdminRow:function(e,i,t){var o=void 0!==e?e:0,a=void 0!==i?i:"";t=void 0!==t?t:"";return['<button type="button" id="image-choices-option-upload-button-'+o+'" class="button image-choices-option-upload-button" onclick="imageChoicesAdmin.OpenMediaLibrary(this);" title="'+imageChoicesFieldStrings.uploadImage+'"><i class="ic-select-icon"></i></button>','<span id="image-choices-option-preview-'+o+'" class="image-choices-option-preview-wrap">','<span class="image-choices-option-preview" style="background-image:url('+a+');"></span>','<a href="javascript:void(0);" class="image-choices-option-image-remove" onclick="imageChoicesAdmin.RemovePreview(this);" title="'+imageChoicesFieldStrings.removeImage+'"><i class="dashicons dashicons-no"></i></a>',"</span>",'<input type="hidden" id="image-choices-option-image-'+o+'" class="image-choices-option-image" value="'+a+'" />','<input type="hidden" id="image-choices-option-image-id-'+o+'" class="image-choices-option-image-id" value="'+t+'" />'].join("")},choicesPreviewRow:function(e,i,t){var o=void 0!==t?t:"";return['<span class="image-choices-choice-image-wrap" style="background-image:url('+o+')">','<img src="'+o+'" alt="" class="image-choices-choice-image" />',"</span>",'<span class="image-choices-choice-text">'+(void 0!==i?i:"")+"</span>"].join("")}},imageChoicesAdmin.getChoices=function(i){void 0===i&&(i=GetSelectedField());imageChoicesAdmin.getSettingsElement().find('[class*="-choice-row"]').each((function(){var t=e(this),o=t.data("index"),a=i.choices.length&&void 0!==i.choices[o].imageChoices_image?i.choices[o].imageChoices_image:"",c=i.choices.length&&void 0!==i.choices[o].imageChoices_imageID?i.choices[o].imageChoices_imageID:"";if(!t.find(".image-choices-option-image").length){var s=t.find('input[id*="_choice_text"]:first');s.length||(s=t.find('input[id*="-choice-text"]:first')),s.length&&s.before(imageChoicesAdmin.markup.choicesAdminRow(o,a,c))}""!==t.find(".image-choices-option-image").val()&&t.addClass("image-choices-has-image")})),imageChoicesAdmin.updateFieldPreview(i)},imageChoicesAdmin.RemovePreview=function(i){if(void 0!==i){var t=e(i).closest('[class*="-choice-row"]');t.find(".image-choices-option-image").val(""),t.find(".image-choices-option-image-id").val(""),t.find(".image-choices-option-preview").css("background-image",""),t.removeClass("image-choices-has-image"),imageChoicesAdmin.UpdateFieldChoicesObject();var o=GetSelectedField();imageChoicesAdmin.updateFieldPreview(o)}},imageChoicesAdmin.UpdateFieldChoicesObject=function(){var i=GetSelectedField();imageChoicesAdmin.getSettingsElement().find('[class*="-choice-row"]').each((function(t){var o=e(this),a=o.find(".image-choices-option-image").val(),c=o.find(".image-choices-option-image-id").val(),s=o.data("index");""!==a?(o.addClass("image-choices-has-image"),o.find(".gf-image-choices-option-preview").css("background-image","url("+a+")")):o.removeClass("image-choices-has-image"),i.choices[s].imageChoices_image=a,i.choices[s].imageChoices_imageID=c}))},imageChoicesAdmin.onProductPriceChange=function(){setTimeout((function(){imageChoicesAdmin.updateFieldPreview(GetSelectedField())}),10)},imageChoicesAdmin.updateFieldPreview=function(i){var t=e("#field_"+i.id),o="product"===i.type&&"singleproduct"===i.inputType,a=t.find(".gfield_label.gform-field-label"),c=t.find(".ic-product-image-wrap"),s=o?"productImage_enabled":"imageChoices_enableImages",n=i.hasOwnProperty(s)&&!0===i[s],m=imageChoicesAdmin.hasProductImage(i);n?o?(!c.length&&m?(a.detach(),(c=e('<div class="ic-product-image-wrap"></div>')).append(`<div class="ic-product-image" style="background-image:url(${i.productImage_image});"><img src="${i.productImage_image}" alt="" class="ic-product-image-element" /></div>`),c.append(a),c.append(`<div class="ic-product-image-price">${i.basePrice}</div>`),t.prepend(c)):!m&&c.length&&(a.detach(),t.prepend(a),c.remove()),m&&t.find(".ic-product-image-price").html(i.basePrice)):(c.length&&(a.detach(),t.prepend(a),c.remove()),n&&void 0===i.imageChoices_showLabels&&imageChoicesAdmin.toggleShowLabels(!0),imageChoicesAdmin.$fieldChoices(t).each((function(t){var o=e(this);if(!o.hasClass("gchoice_total")){o.addClass("image-choices-choice");var a=o.find("label"),c=a.find(".image-choices-choice-text").length?a.find(".image-choices-choice-text").html():a.html();if(i.imageChoices_enableImages){if(i.choices.length>t){var s=void 0!==i.choices[t].imageChoices_image?i.choices[t].imageChoices_image:"";a.html(imageChoicesAdmin.markup.choicesPreviewRow(t,c,s))}}else a.html(c)}}))):c.length&&(a.detach(),t.prepend(a),c.remove())},imageChoicesAdmin.getField=function(){var i=GetSelectedField();return e("#field_"+i.id)},imageChoicesAdmin.removeAllChoices=function(){imageChoicesAdmin.getSettingsElement().find(".image-choices-option-image-remove").each((function(){e(this).trigger("click")})),$settingsWrap.find(".gf_delete_field_choice").each((function(){e(this).trigger("click")})),$settingsWrap.find('.field-choice-row input[type="text"], .gquiz-choice-row input[type="text"]').val("")},imageChoicesAdmin.isColorPickerPluginActive=function(){return window.hasOwnProperty("colorPickerFieldVars")&&void 0!==window.colorPickerFieldVars},imageChoicesAdmin.isImageChoicesEnabled=function(e){return e=e||GetSelectedField(),imageChoicesAdmin.fieldCanHaveImages(e)&&!0===e.imageChoices_enableImages},imageChoicesAdmin.hasImageChoicesImage=function(e){return e=e||GetSelectedField(),imageChoicesAdmin.isImageChoicesEnabled(e)&&e.hasOwnProperty("imageChoices_image")&&""!==e.imageChoices_image},imageChoicesAdmin.isProductImageField=function(e){return"product"===(e=e||GetSelectedField()).type&&"singleproduct"===e.inputType},imageChoicesAdmin.isProductImageEnabled=function(e){return e=e||GetSelectedField(),imageChoicesAdmin.isProductImageField(e)&&!0===e.productImage_enabled},imageChoicesAdmin.hasProductImage=function(e){return e=e||GetSelectedField(),imageChoicesAdmin.isProductImageField(e)&&e.hasOwnProperty("productImage_image")&&""!==e.productImage_image},imageChoicesAdmin.hasProductImageId=function(e){return e=e||GetSelectedField(),imageChoicesAdmin.isProductImageField(e)&&e.hasOwnProperty("productImage_imageId")&&e.productImage_imageId},imageChoicesAdmin.onProductImageToggleClick=function(i){imageChoicesAdmin.toggleEnableImages(i.checked,!0),i.checked&&(imageChoicesAdmin.hasProductImage()||(e("#product_image_tab_toggle").click(),setTimeout((function(){e("#product-image-button").click()}),500)))},imageChoicesAdmin.toggleEnableImages=function(e,i){var t=!0===i,o=t?"input.field_product_image_enabled":"input.field_choice_images_enabled",a=imageChoicesAdmin.getSettingsElement(),c=a.find(o);if(void 0===e&&(e=c.is(":checked")),t)imageChoicesAdmin.onToggleEnableImages(e,t);else{var s=a.find("input.field_color_picker_enabled");e&&imageChoicesAdmin.isColorPickerPluginActive()&&s.length&&s.is(":checked")?window.confirm(imageChoicesFieldStrings.confirmImagesToggle)?(window.hasOwnProperty("colorPicker_toggleEnableColors")&&"function"==typeof window.colorPicker_toggleEnableColors&&window.colorPicker_toggleEnableColors(!1),imageChoicesAdmin.onToggleEnableImages(e,t)):c.prop("checked",!1):imageChoicesAdmin.onToggleEnableImages(e,t)}},window.imageChoices_toggleEnableImages=imageChoicesAdmin.toggleEnableImages,imageChoicesAdmin.onToggleEnableImages=function(i,t){var o=GetSelectedField();if(o){var a=!0===t,c=a?"input.field_product_image_enabled":"input.field_choice_images_enabled",s=imageChoicesAdmin.getField(),n=imageChoicesAdmin.getSettingsElement(),m=n.find(c);if(void 0===i&&(i=m.is(":checked")),s.toggleClass("image-choices-admin-field",i),a){SetFieldProperty("productImage_enabled",i),m.prop("checked",i),e("#product_image_tab_toggle").toggle(i);var g=s.find(".ic-product-image-wrap");if(!i&&g.length){var d=s.find(".gfield_label.gform-field-label");d.detach(),s.prepend(d),g.remove()}s.toggleClass("product-image-admin-field",i),s.toggleClass("product-image-enabled",i),n.toggleClass("product-image-enabled",i)}else{SetFieldProperty("imageChoices_enableImages",i),m.prop("checked",i),e("#image_choices_tab_toggle").toggle(i);var l="quiz"===o.type.toLowerCase()?"#gquiz_gfield_settings_choices_container":"#gfield_settings_choices_container";e(l).toggleClass("image-choices-enabled",i),s.toggleClass("image-choices-use-images",i),n.toggleClass("image-choices-use-images",i);var r=n.find(".image-choices-remove-choices-btn");i||r.length&&r.remove();var h=e(".field_setting.other_choice_setting");("radio"===o.type||"poll"===o.type&&"radio"===o.inputType)&&h.show()}imageChoicesAdmin.updateFieldPreview(o)}},imageChoicesAdmin.toggleShowLabels=function(e){var i=imageChoicesAdmin.getField(),t=imageChoicesAdmin.getSettingsElement().find("input.image_choices_show_labels");void 0===e&&(e=t.is(":checked")),SetFieldProperty("imageChoices_showLabels",e),t.prop("checked",e),i.toggleClass("image-choices-show-labels",e)},imageChoicesAdmin.toggleShowPrices=function(e){var i=imageChoicesAdmin.getField(),t=imageChoicesAdmin.getSettingsElement().find("input.image_choices_show_prices");void 0===e&&(e=t.is(":checked")),SetFieldProperty("imageChoices_showPrices",e),t.prop("checked",e),i.toggleClass("image-choices-show-prices",e)},imageChoicesAdmin.toggleUseLightboxCaption=function(e,i){imageChoicesAdmin.getField();var t=!0===i,o=t?"input.product_image_use_lightbox_caption":"input.image_choices_use_lightbox_caption",a=imageChoicesAdmin.getSettingsElement().find(o);void 0===e&&(e=a.is(":checked")),a.prop("checked",e),t?SetFieldProperty("productImage_useLightboxCaption",e):SetFieldProperty("imageChoices_useLightboxCaption",e)},imageChoicesAdmin.toggleUseLightbox=function(i,t){var o=GetSelectedField(),a=imageChoicesAdmin.getField(),c=!0===t,s=c?"input.product_image_use_lightbox":"input.image_choices_use_lightbox",n=imageChoicesAdmin.getSettingsElement().find(s),m=c?".product-image-setting-use-lightbox-caption":".image-choices-setting-use-lightbox-caption";if(void 0===i&&(i=n.is(":checked")),n.prop("checked",i),c){if(SetFieldProperty("productImage_useLightbox",i),a.toggleClass("product-image-use-lightbox",i),imageChoicesAdmin.hasProductImage(o)&&!imageChoicesAdmin.hasProductImageId(o))return window.alert(imageChoicesFieldStrings.useLightboxWarning),!1}else SetFieldProperty("imageChoices_useLightbox",i),a.toggleClass("image-choices-use-lightbox",i),i&&e.each(o.choices,(function(e,i){var t=i.hasOwnProperty("imageChoices_image")&&""!==i.imageChoices_image,o=i.hasOwnProperty("imageChoices_imageID")&&""!==i.imageChoices_imageID;if(t&&!o)return window.alert(imageChoicesFieldStrings.useLightboxWarning),!1}));document.querySelector(m).style.setProperty("display",i?"block":"none","important")},imageChoicesAdmin.updateEntrySetting=function(e,i){var t=!0===i,o=t?"product-image":"image-choices";SetFieldProperty(`${t?"productImage":"imageChoices"}_entrySetting`,e),imageChoicesAdmin.getSettingsElement().find(`#${o}-entry-value`).val(e)},imageChoicesAdmin.OpenMediaLibrary=function(i){if(void 0!==i){var t,o=GetSelectedField(),a=imageChoicesAdmin.isProductImageField(o);if(a){var c=imageChoicesAdmin.getField();t=c.data("file-frame")}else{var s=e(i).closest('[class*="-choice-row"]');t=s.data("file-frame")}t?t.open():(t=wp.media({title:"Select an image to upload",button:{text:"Use this image"},frame:"post",state:"insert",multiple:!1}),setTimeout((function(){e('input[value="Insert into Post"]').val("Use this Image"),e("button.media-button-insert").text("Use this Image")}),100),jQuery("body").on("click","li.attachment",(function(){e('input[value="Insert into Post"]').val("Use this Image"),e("button.media-button-insert").text("Use this Image")})),t.on("insert",(function(i){var c=t.state();if(i=i||c.get("selection")){var n=i.first(),m=c.display(n).toJSON();n=n.toJSON();var g,d=["medium","thumbnail","full"];if(m&&m.hasOwnProperty("size")&&m.size&&d.unshift(m.size),n.hasOwnProperty("sizes")){for(var l=0,r=d[l].toString();!n.sizes.hasOwnProperty(r)||!n.sizes[r].hasOwnProperty("url")||""===n.sizes[r].url;)r=d[++l].toString();g=n.sizes[r].url,r}else g=n.url,"full";if(a)imageChoicesAdmin.updateProductImage(g,n.id);else{s.find(".image-choices-option-image").val(g),s.find(".image-choices-option-image-id").val(n.id),s.find(".image-choices-option-preview").css("background-image","url("+g+")"),s.addClass("image-choices-has-image"),imageChoicesAdmin.UpdateFieldChoicesObject(),imageChoicesAdmin.updateFieldPreview(o);var h=e("#choices-ui-flyout");h.length&&h.addClass("gform-flyout--anim-in-ready gform-flyout--anim-in-active")}}})),t.open(),a?c.data("file-frame",t):s.data("file-frame",t))}},imageChoicesAdmin.fieldCanHaveImages=function(e){if(void 0===e||!e.hasOwnProperty("type"))return!1;var i="radio"===e.type||"checkbox"===e.type||"quiz"===e.type&&"radio"==e.inputType||"quiz"===e.type&&"checkbox"==e.inputType||"poll"===e.type&&"radio"==e.inputType||"poll"===e.type&&"checkbox"==e.inputType||"post_custom_field"===e.type&&"radio"==e.inputType||"post_custom_field"===e.type&&"checkbox"==e.inputType||"survey"===e.type&&"radio"==e.inputType||"survey"===e.type&&"checkbox"==e.inputType||"product"===e.type&&"radio"==e.inputType||"shipping"===e.type&&"radio"==e.inputType||"option"===e.type&&"radio"==e.inputType||"option"===e.type&&"checkbox"==e.inputType;return gform.applyFilters("gfic_field_can_have_images",i,e)},imageChoicesAdmin.$fieldChoices=function(e){if(void 0===e||e instanceof jQuery==!1)return[];return e.find('.ginput_container .gfield_radio div[class*="gchoice"], .ginput_container .gfield_checkbox .gchoice:not(.gchoice_select_all)')},imageChoicesAdmin.getSettingsElement=function(){var i="#field_settings_container";return i+="quiz"===GetSelectedField().type?", #gquiz_gfield_settings_choices_container":", #gfield_settings_choices_container",e(i)},imageChoicesAdmin.previewHeight=function(e){if("object"!=typeof e){var i=imageChoicesAdmin.getField();e=i.find(".ginput_container")}e.length&&e.closest(".gfield").hasClass("image-choices-admin-field")&&setTimeout((function(){e.height(e.find("> ul:first").outerHeight())}),20)},imageChoicesAdmin.updateProductImage=function(e,i){var t=imageChoicesAdmin.getSettingsElement(),o=imageChoicesAdmin.getField();void 0===e&&(e=""),void 0===i&&(i=""),SetFieldProperty("productImage_image",e),SetFieldProperty("productImage_imageId",i),t.find(".product-image-url").val(e),t.find(".product-image-id").val(i),t.find("#product-image-preview").css("background-image","url("+e+")"),t.toggleClass("has-product-image",""!==e),o.toggleClass("has-product-image",""!==e),imageChoicesAdmin.updateFieldPreview(GetSelectedField())},imageChoicesAdmin.updateThemeSetting=function(i,t){var o=!0===t,a=o?"product-image":"image-choices";SetFieldProperty(`${o?"productImage":"imageChoices"}_theme`,i),imageChoicesAdmin.getSettingsElement().find(`#${a}-theme`).val(i);var c,s=e(`#${a}-theme-preview`);s.toggle("none"!==i),"none"===i?s.hide().find("img").hide():"form_setting"===i?((i=window.form.hasOwnProperty("gf-image-choices")&&window.form["gf-image-choices"].hasOwnProperty("gf_image_choices_theme")?window.form["gf-image-choices"].gf_image_choices_theme:"")&&"global_setting"!==i||(i=imageChoicesVars.hasOwnProperty("globals")&&imageChoicesVars.globals.hasOwnProperty("theme")?imageChoicesVars.globals.theme:imageChoicesVars.hasOwnProperty("defaults")&&imageChoicesVars.defaults.hasOwnProperty("theme")?imageChoicesVars.defaults.theme:"simple"),s.find("img").hide(),(c=s.find(`img.${a}-theme-preview-${i}`)).length&&c.show()):(s.find("img").hide(),(c=s.find(`img.${a}-theme-preview-${i}`)).length&&c.show())},imageChoicesAdmin.updateFeatureColorSetting=function(e){SetFieldProperty("imageChoices_featureColor",e);var i=imageChoicesAdmin.getSettingsElement().find('[for="image-choices-feature-color-custom"]'),t=imageChoicesAdmin.getSettingsElement().find("#image-choices-feature-color-custom"),o=imageChoicesAdmin.getSettingsElement().find(".image-choices-setting-feature-color .wp-picker-container"),a=t.val();imageChoicesAdmin.getSettingsElement().find("#image-choices-feature-color").val(e),"custom"===e?(i.show(),t.show(),o.length?(o.show(),setTimeout((function(){""!==a?t.wpColorPicker("color",a):o.find(".wp-picker-clear").trigger("click")}),100)):(t.wpColorPicker({change:function(e,i){imageChoicesAdmin.updateCustomFeatureColor(i.color.toString())}}),setTimeout((function(){""!==a?t.wpColorPicker("color",a):o.find(".wp-picker-clear").trigger("click")}),100))):(i.hide(),t.hide(),o.length&&(o.find(".wp-picker-clear").trigger("click"),o.hide()))},imageChoicesAdmin.updateCustomFeatureColor=function(e,i){var t=!0===i,o=t?"productImage":"imageChoices",a=t?"product-image":"image-choices";imageChoicesAdmin.getSettingsElement().find(`#${a}-feature-color-custom`).val(e),SetFieldProperty(`${o}_featureColorCustom`,e)},imageChoicesAdmin.updateAlignSetting=function(e){SetFieldProperty("imageChoices_align",e),imageChoicesAdmin.getSettingsElement().find("#image-choices-align").val(e)},imageChoicesAdmin.updateImageStyleSetting=function(e,i){var t=!0===i,o=t?"product-image":"image-choices";SetFieldProperty(`${t?"productImage":"imageChoices"}_imageStyle`,e),imageChoicesAdmin.getSettingsElement().find(`#${o}-image-style`).val(e)},imageChoicesAdmin.validateNumericValue=function(e){var i="";if(""!==(e=e.toString()).trim()){var t=parseInt(e,10);i=isNaN(t)||t<=0?"":t.toString()}return i!==e?i:e},imageChoicesAdmin.updateColumnsSetting=function(e){SetFieldProperty("imageChoices_columns",e);var i=imageChoicesAdmin.getSettingsElement();i.find("#image-choices-columns").val(e),i.find(".image-choices-setting-columns-width").toggle("fixed"===e)},imageChoicesAdmin.updateColumnsWidthSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_columnsWidth",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-columns-width").val(i)},imageChoicesAdmin.updateColumnsMediumSetting=function(e){SetFieldProperty("imageChoices_columnsMedium",e);var i=imageChoicesAdmin.getSettingsElement();i.find("#image-choices-columns-medium").val(e),i.find(".image-choices-setting-columns-width-medium").toggle("fixed"===e)},imageChoicesAdmin.updateColumnsMediumWidthSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_columnsWidthMedium",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-columns-width-medium").val(i)},imageChoicesAdmin.updateColumnsSmallSetting=function(e){SetFieldProperty("imageChoices_columnsSmall",e);var i=imageChoicesAdmin.getSettingsElement();i.find("#image-choices-columns-small").val(e),i.find(".image-choices-setting-columns-width-small").toggle("fixed"===e)},imageChoicesAdmin.updateColumnsSmallWidthSetting=function(e){var i=imageChoicesAdmin.validateNumericValue(e);SetFieldProperty("imageChoices_columnsWidthSmall",i),imageChoicesAdmin.getSettingsElement().find("#image-choices-columns-width-small").val(i)},imageChoicesAdmin.updateHeightSetting=function(e,i){var t=imageChoicesAdmin.validateNumericValue(e),o=!0===i,a=o?"product-image":"image-choices";SetFieldProperty(`${o?"productImage":"imageChoices"}_height`,t),imageChoicesAdmin.getSettingsElement().find(`#${a}-height`).val(t)},imageChoicesAdmin.updateMediumHeightSetting=function(e,i){var t=imageChoicesAdmin.validateNumericValue(e),o=!0===i,a=o?"product-image":"image-choices";SetFieldProperty(`${o?"productImage":"imageChoices"}_heightMedium`,t),imageChoicesAdmin.getSettingsElement().find(`#${a}-height-medium`).val(t)},imageChoicesAdmin.updateSmallHeightSetting=function(e,i){var t=imageChoicesAdmin.validateNumericValue(e),o=!0===i,a=o?"product-image":"image-choices";SetFieldProperty(`${o?"productImage":"imageChoices"}_heightSmall`,t),imageChoicesAdmin.getSettingsElement().find(`#${a}-height-small`).val(t)},imageChoicesAdmin.initProductImageField=function(i){var t=e("#field_"+i.id);t.addClass("product-image-admin-field"),t.addClass("product-image-enabled"),imageChoicesAdmin.hasProductImage(i)&&t.addClass("has-product-image"),imageChoicesAdmin.updateFieldPreview(i)},imageChoicesAdmin.initImageChoicesField=function(i){var t=e("#field_"+i.id);t.addClass("image-choices-admin-field"),t.addClass("image-choices-enabled"),imageChoicesAdmin.hasImageChoicesImage(i)&&t.addClass("image-choices-has-image"),imageChoicesAdmin.updateFieldPreview(i)};var t="1"===imageChoicesVars.skipImageChoicesFieldAlert.toString()||"true"===imageChoicesVars.skipImageChoicesFieldAlert.toString();imageChoicesAdmin.formEditorInit=function(){parseFloat(imageChoicesVars.gf_version)>=2.9&&(e(document).on("gform_field_added",(function(e,i,o){"image_choice"!==o.type||t||imageChoicesAdmin.alert({title:"Just checking...",content:'You\'ve added Gravity Forms\' native Image Choices field. This is different from JetSloth\'s Image Choices, which is a toggle on Radio Button and Checkbox fields.<br/><br/>Need help? <a href="https://jetsloth.com/articles/image-choices/native-image-choices-in-gravity-forms-2-9-vs-jetsloths-premium-add-on-a-comparison/" target="_blank">Learn more</a>.<br/><br/><label><input type="checkbox" name="gfic_skip_image_choices_field_alert" id="gfic_skip_image_choices_field_alert" value="1"><span>Don\'t show this again.</span></label>'})})),e("body").on("change","input#gfic_skip_image_choices_field_alert",(function(i){t=document.getElementById("gfic_skip_image_choices_field_alert").checked,e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_skip_image_choices_field_alert",skip:t}})}))),gform.addAction("gform_after_refresh_field_preview",(function(e){var i=GetSelectedField();imageChoicesAdmin.isImageChoicesEnabled(i)&&imageChoicesAdmin.updateFieldPreview(i)})),form.fields.forEach((function(e){imageChoicesAdmin.isProductImageEnabled(e)?imageChoicesAdmin.initProductImageField(e):imageChoicesAdmin.isImageChoicesEnabled(e)&&imageChoicesAdmin.initImageChoicesField(e)})),e(".gfield.image-choices-admin-field").each((function(){imageChoicesAdmin.$fieldChoices(e(this)).each((function(){let i=e(this);i.hasClass("gchoice_total")||i.addClass("image-choices-choice")}))})),e("#gform_fields .gfield .ginput_container").each((function(){imageChoicesAdmin.previewHeight(e(this))})),e(window).on("gf_update_field_choices",(function(){setTimeout((function(){imageChoicesAdmin.getChoices()}),10),imageChoicesAdmin.previewHeight()})),e(document).on("click",".gf_insert_field_choice, .gf_delete_field_choice",(function(e){imageChoicesAdmin.previewHeight()})),gform.addAction("gform_load_field_choices",(function(i){setTimeout((function(){var t=void 0!==i&&i.length?i[0]:GetSelectedField(),o=e("#field_"+t.id),a=imageChoicesAdmin.getSettingsElement();if(imageChoicesAdmin.isProductImageField(t)){e("#field_base_price").on("change",imageChoicesAdmin.onProductPriceChange);var c=imageChoicesAdmin.isProductImageEnabled(t),s=void 0!==t.productImage_image?t.productImage_image:"",n=void 0!==t.productImage_imageId?t.productImage_imageId:"",m=void 0!==t.productImage_useLightbox&&t.productImage_useLightbox,g=void 0!==t.productImage_theme?t.productImage_theme:"form_setting",d=void 0!==t.productImage_imageStyle?t.productImage_imageStyle:"form_setting",l=void 0===t.productImage_useLightboxCaption||t.productImage_useLightboxCaption;"form_setting"!==l&&""!==l||(l=!0);var r=void 0!==t.productImage_height?t.productImage_height:"",h=void 0!==t.productImage_heightMedium?t.productImage_heightMedium:"",u=void 0!==t.productImage_heightSmall?t.productImage_heightSmall:"",p=void 0!==t.productImage_entrySetting?t.productImage_entrySetting:"form_setting";a.addClass("product-image-field-settings"),imageChoicesAdmin.toggleEnableImages(c,!0),imageChoicesAdmin.updateProductImage(s,n),imageChoicesAdmin.toggleUseLightbox(m,!0),imageChoicesAdmin.toggleUseLightboxCaption(l,!0),imageChoicesAdmin.updateThemeSetting(g,!0),imageChoicesAdmin.updateImageStyleSetting(d,!0),imageChoicesAdmin.updateHeightSetting(r,!0),imageChoicesAdmin.updateMediumHeightSetting(h,!0),imageChoicesAdmin.updateSmallHeightSetting(u,!0),imageChoicesAdmin.updateEntrySetting(p,!0)}else imageChoicesAdmin.toggleEnableImages(!1,!0),imageChoicesAdmin.updateProductImage(""),imageChoicesAdmin.toggleUseLightboxCaption(!0,!0),imageChoicesAdmin.updateThemeSetting("form_setting",!0),imageChoicesAdmin.updateImageStyleSetting("form_setting",!0),imageChoicesAdmin.updateHeightSetting("",!0),imageChoicesAdmin.updateMediumHeightSetting("",!0),imageChoicesAdmin.updateSmallHeightSetting("",!0),imageChoicesAdmin.updateEntrySetting("",!0),o.removeClass("product-image-admin-field"),a.removeClass("product-image-field-settings");if(imageChoicesAdmin.fieldCanHaveImages(t)){var f=!0===t.imageChoices_enableImages,_=void 0!==t.imageChoices_useLightbox&&t.imageChoices_useLightbox,C=void 0===t.imageChoices_showLabels||t.imageChoices_showLabels,v="product"===t.type&&void 0!==t.imageChoices_showPrices&&t.imageChoices_showPrices,A=void 0!==t.imageChoices_entrySetting?t.imageChoices_entrySetting:"form_setting",b=void 0!==t.imageChoices_theme?t.imageChoices_theme:"form_setting",w=void 0!==t.imageChoices_featureColor?t.imageChoices_featureColor:"form_setting",y=void 0!==t.imageChoices_featureColorCustom?t.imageChoices_featureColorCustom:"",S=void 0!==t.imageChoices_align?t.imageChoices_align:"form_setting",I=void 0!==t.imageChoices_imageStyle?t.imageChoices_imageStyle:"form_setting",P=void 0!==t.imageChoices_columns?t.imageChoices_columns:"form_setting",F=void 0!==t.imageChoices_columnsWidth?t.imageChoices_columnsWidth:"",k=void 0!==t.imageChoices_columnsMedium?t.imageChoices_columnsMedium:"form_setting",x=void 0!==t.imageChoices_columnsWidthMedium?t.imageChoices_columnsWidthMedium:"",E=void 0!==t.imageChoices_columnsSmall?t.imageChoices_columnsSmall:"form_setting",T=void 0!==t.imageChoices_columnsWidthSmall?t.imageChoices_columnsWidthSmall:"",$=void 0===t.imageChoices_useLightboxCaption||t.imageChoices_useLightboxCaption;"form_setting"!==$&&""!==$||($=!0);var L=void 0!==t.imageChoices_height?t.imageChoices_height:"",O=void 0!==t.imageChoices_heightMedium?t.imageChoices_heightMedium:"",j=void 0!==t.imageChoices_heightSmall?t.imageChoices_heightSmall:"";a.addClass("image-choices-field-settings"),"product"===t.type&&a.addClass("image-choices-product-field"),imageChoicesAdmin.toggleEnableImages(f),imageChoicesAdmin.toggleUseLightbox(_),imageChoicesAdmin.toggleShowLabels(C),imageChoicesAdmin.toggleShowPrices(v),imageChoicesAdmin.updateEntrySetting(A),imageChoicesAdmin.toggleUseLightboxCaption($),imageChoicesAdmin.isLegacyMode()||(imageChoicesAdmin.updateThemeSetting(b),imageChoicesAdmin.updateCustomFeatureColor(y),imageChoicesAdmin.updateFeatureColorSetting(w),imageChoicesAdmin.updateAlignSetting(S),imageChoicesAdmin.updateImageStyleSetting(I),imageChoicesAdmin.updateHeightSetting(L),imageChoicesAdmin.updateMediumHeightSetting(O),imageChoicesAdmin.updateSmallHeightSetting(j),imageChoicesAdmin.updateColumnsWidthSetting(F),imageChoicesAdmin.updateColumnsMediumWidthSetting(x),imageChoicesAdmin.updateColumnsSmallWidthSetting(T),imageChoicesAdmin.updateColumnsSetting(P),imageChoicesAdmin.updateColumnsMediumSetting(k),imageChoicesAdmin.updateColumnsSmallSetting(E)),imageChoicesAdmin.getChoices(t)}else imageChoicesAdmin.toggleEnableImages(!1),imageChoicesAdmin.toggleUseLightboxCaption(!0),imageChoicesAdmin.isLegacyMode()||(imageChoicesAdmin.updateThemeSetting("form_setting"),imageChoicesAdmin.updateCustomFeatureColor(""),imageChoicesAdmin.updateFeatureColorSetting("form_setting"),imageChoicesAdmin.updateAlignSetting("form_setting"),imageChoicesAdmin.updateImageStyleSetting("form_setting"),imageChoicesAdmin.updateHeightSetting(""),imageChoicesAdmin.updateMediumHeightSetting(""),imageChoicesAdmin.updateSmallHeightSetting(""),imageChoicesAdmin.updateColumnsWidthSetting(""),imageChoicesAdmin.updateColumnsMediumWidthSetting(""),imageChoicesAdmin.updateColumnsSmallWidthSetting(""),imageChoicesAdmin.updateColumnsSetting("form_setting"),imageChoicesAdmin.updateColumnsMediumSetting("form_setting"),imageChoicesAdmin.updateColumnsSmallSetting("form_setting")),o.removeClass("image-choices-show-labels"),a.removeClass("image-choices-field-settings"),a.remove("image-choices-product-field")}),100)})),e(document).bind("gform_load_field_settings",(function(i,t,o){"function"!=typeof window.imageChoices_GF_UpdateFieldChoices&&"function"==typeof UpdateFieldChoices&&(window.imageChoices_GF_UpdateFieldChoices=UpdateFieldChoices,window.UpdateFieldChoices=function(){window.imageChoices_GF_UpdateFieldChoices.apply(this,arguments),e(window).trigger("gf_update_field_choices")}),imageChoicesAdmin.previewHeight()}))},imageChoicesAdmin.formEditorLegacyWarning=function(){},imageChoicesAdmin.adminInit=()=>{var i=e("#gf_image_choices_custom_css_global, #gf_image_choices_custom_css, #gf_image_choices_user_css_global, #gf_image_choices_user_css_form");if(i.length){var t=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};t.codemirror=_.extend({},t.codemirror,{indentUnit:4,tabSize:4,mode:"css",lineNumbers:!0,autoCloseBrackets:!0,continueComments:!0,indentWithTabs:!0,inputStyle:"contenteditable",lineWrapping:!0,lint:!1,matchBrackets:!0,styleActiveLine:!0,gutters:[],extraKeys:{"Alt-F":"findPersistent","Cmd-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-/":"toggleComment","Ctrl-/":"toggleComment","Ctrl-Space":"autocomplete"}}),i.each((function(){window[this.id+"_editor"]=wp.codeEditor.initialize(e(this),t)}))}var o=e("#gform_settings_section_collapsed_gf_image_choices_legacy_custom_css_section, #gform_settings_section_collapsed_gf_image_choices_legacy_custom_form_css_section");o.length&&o.on("click",(function(){e(this).closest(".gform-settings-panel").find("textarea").each((function(){var i=e(this).attr("id")+"_editor";try{window[i].codemirror.refresh()}catch(e){}}))}));var a=e("#_gform_setting_gf_image_choices_use_legacy_styles"),c=e("#gform-settings-section-theme, #gform-settings-section-feature-color, #gform-settings-section-choices-layout, #gform-settings-section-image-options, #gform-settings-section-custom-css, #gform-settings-section-gf_image_choices_legacy_custom_css_section .gform-settings-label");a.length&&(a.on("change",(function(e){var i=a.is(":checked");c.length&&c.toggle(!i),o.length&&(i&&o.is(":checked")||!i&&!o.is(":checked"))&&o.click()})),a.trigger("change"));var s=e("#tab_gf-image-choices .gform-settings-tabs__navigation a");s.length&&(s.each((function(){e(this).on("click",(function(i){window.location.hash=i.currentTarget.id.replace("gform-settings-tab-gf_image_choices_",""),e("#tab_gf-image-choices #gform-settings-save").toggle("gf_image_choices_settings_tab"===e(this).data("tab"))}))})),setTimeout((()=>{const e=window.location.hash.substring(1),i=""!==e?document.querySelector(`#tab_gf-image-choices #gform-settings-tab-gf_image_choices_${e}`):null;(i||s[0]).dispatchEvent(new Event("click"))}),100));var n=e('input[id^="gf_image_choices"][id*="columns_width"], input[id^="image-choices"][id*="columns-width"], input[id^="gf_image_choices"][id*="height"], input[id^="image-choices"][id*="height"], input[id^="product-image"][id*="height"]');n.length&&n.each((function(){e(this).on("keyup",(function(e){var i=e.currentTarget.value.toString(),t=imageChoicesAdmin.validateNumericValue(i);t!==i&&(e.currentTarget.value=t)}))}));var m=e("#gf_image_choices_theme, #gf_image_choices_global_theme").first(),g=e("#gform_setting_gf_image_choices_theme_preview .image-choices-theme-preview, #gform_setting_gf_image_choices_global_theme_preview .image-choices-theme-preview").first();m.length&&g.length&&(m.on("change",(function(i){var t=e(this).val();""!==t&&"global_setting"!=t||(t=imageChoicesVars.hasOwnProperty("globals")&&imageChoicesVars.globals.hasOwnProperty("theme")?imageChoicesVars.globals.theme:imageChoicesVars.hasOwnProperty("defaults")&&imageChoicesVars.defaults.hasOwnProperty("theme")?imageChoicesVars.defaults.theme:"simple"),g.toggle("none"!==t),"none"===t?g.hide().find("img").hide():(g.find("img").hide(),g.find("img.image-choices-theme-preview-"+t).show())})),m.trigger("change"));var d,l,r=e("#gf_image_choices_feature_color, #gf_image_choices_global_feature_color").first(),h=e("#gform_setting_gf_image_choices_feature_color_custom, #gform_setting_gf_image_choices_global_feature_color_custom").first(),u=e("#gf_image_choices_feature_color_custom, #gf_image_choices_global_feature_color_custom").first();r.length&&h.length&&(l=h.find(".wp-picker-container"),d=u.val(),r.on("change",(function(i){"custom"===e(this).val()?(h.show(),l.length?setTimeout((function(){""!==customColor?u.wpColorPicker("color",d):l.find(".wp-picker-clear").trigger("click")}),100):(u.wpColorPicker(),setTimeout((function(){""!==d?u.wpColorPicker("color",d):l.find(".wp-picker-clear").trigger("click")}),100))):(h.hide(),l.length&&l.find(".wp-picker-clear").trigger("click"))})),r.trigger("change"));var p=e("#image_choices_url_replacement"),f=p.length?e("#image_choices_url_replacement_submit"):null,C=p.length?p.find(".jetbase-tool__progress"):null,v=p.length?p.find(".jetbase-tool__progress-percent"):null,A=p.length?p.find(".jetbase-tool__progress-status"):null,b={old:"",new:"",forms:[],index:0,replacements:[]};imageChoicesAdmin.processUrlReplacement=function(){if(!b.forms.length||b.replacements.length===b.forms.length||b.index>=b.forms.length)return v.css("width","100%"),A.html(`Done! ${b.forms.length} form(s) processed`),p.removeClass("busy"),void(w.length&&w.removeClass("disabled"));e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_url_replacement",id:b.forms[b.index],old:b.old,new:b.new},beforeSend:function(e,i){A.html(`Processing form ${b.index+1}/${b.forms.length}`)},success:function(e){e&&e.success?b.replacements[b.index]=e.total:e&&e.error?(b.replacements[b.index]=!1,A.html("Error: "+e.error)):(b.replacements[b.index]=!1,A.html("Error")),b.index++,v.css("width",`${Math.ceil(b.index/b.forms.length*100)}%`),imageChoicesAdmin.processUrlReplacement()}})},f&&f.length&&f.on("click",(function(i){i.preventDefault();var t=p.find("#image_choices_url_replacement_form_select").val().trim(),o=p.find("#image_choices_url_replacement_from_input").val().trim(),a=p.find("#image_choices_url_replacement_to_input").val().trim();o&&a&&o!==a&&(b.old=o,b.new=a,b.forms=[],b.index=0,b.replacements=[],"all"===t?(A.html("Scanning for forms with old URL in image choices..."),v.css("width","0%"),p.addClass("busy"),C.addClass("active"),w.length&&w.addClass("disabled"),e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_get_url_replacement_form_ids",form_id:b.formId,old:b.old,new:b.new},success:function(e){e&&e.success?e.forms&&e.forms.length?(b.forms=e.forms,imageChoicesAdmin.processUrlReplacement()):(v.css("width","100%"),A.html("Done! No image choices found containing that old URL"),p.removeClass("busy"),w.length&&w.removeClass("disabled")):e&&e.error?A.html("Error: "+e.error):A.html("Error")}})):(A.html("..."),v.css("width","0%"),p.addClass("busy"),C.addClass("active"),w.length&&w.addClass("disabled"),b.forms=[t],imageChoicesAdmin.processUrlReplacement()))}));var w=e("#image_choices_image_replacement"),y=w.length?e("#image_choices_image_replacement_submit"):null,S=w.length?w.find(".jetbase-tool__progress"):null,I=w.length?w.find(".jetbase-tool__progress-percent"):null,P=w.length?w.find(".jetbase-tool__progress-status"):null,F={new:"",forms:[],index:0,replacements:[]};imageChoicesAdmin.processSizeReplacement=function(){if(!F.forms.length||F.replacements.length===F.forms.length||F.index>=F.forms.length)return I.css("width","100%"),P.html(`Done! ${F.forms.length} form(s) processed`),w.removeClass("busy"),void(p.length&&p.removeClass("disabled"));e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_image_size_replacement",id:F.forms[F.index],new:F.new},beforeSend:function(e,i){P.html(`Processing form ${F.index+1}/${F.forms.length}`)},success:function(e){e&&e.success?F.replacements[F.index]=e.total:e&&e.error?(F.replacements[F.index]=!1,P.html("Error: "+e.error)):(F.replacements[F.index]=!1,P.html("Error")),F.index++,I.css("width",`${Math.ceil(F.index/F.forms.length*100)}%`),imageChoicesAdmin.processSizeReplacement()}})},y&&y.length&&y.on("click",(function(i){i.preventDefault();var t=w.find("#image_choices_image_replacement_size_select").val().trim(),o=w.find("#image_choices_image_replacement_form_select").val().trim();t&&(F.new=t,F.forms=[],F.index=0,F.replacements=[],"all"===o?(P.html("Scanning for forms with image choices enabled..."),I.css("width","0%"),w.addClass("busy"),S.addClass("active"),p.length&&p.addClass("disabled"),e.ajax({url:window.ajaxurl,method:"POST",data:{action:"gf_image_choices_get_image_size_replacement_form_ids"},success:function(e){e&&e.success?e.forms&&e.forms.length?(F.forms=e.forms,imageChoicesAdmin.processSizeReplacement()):(I.css("width","100%"),P.html("Done! No forms found with image choices enabled"),w.removeClass("busy"),p.length&&p.removeClass("disabled")):e&&e.error?P.html("Error: "+e.error):P.html("Error")}})):(P.html("..."),I.css("width","0%"),w.addClass("busy"),S.addClass("active"),p.length&&p.addClass("disabled"),F.forms=[o],imageChoicesAdmin.processSizeReplacement()))}))};var o,a=!1;e(document).ready((function(){a||(o=setInterval((function(){"undefined"!=typeof gform&&(a=!0,clearInterval(o),imageChoicesAdmin.adminInit())}),100))})),e(document).bind("gform_main_scripts_loaded",(function(){void 0!==window.form&&(1===imageChoicesAdmin.markupDetect()&&imageChoicesAdmin.formHasImageChoicesFields()&&imageChoicesAdmin.formEditorLegacyWarning(),imageChoicesAdmin.formEditorInit())}))}(jQuery);
//# sourceMappingURL=gf_image_choices_admin.js.map
