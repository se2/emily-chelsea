{"version":3,"file":"gf_image_choices_admin.js","names":["imageChoicesAdmin","$","GF_MARKUP_VERSION","extend","arguments","extended","deep","i","merge","obj","prop","hasOwnProperty","Object","prototype","toString","call","length","__dialogDefaults","dialogType","cancelText","confirmText","allowCancel","promptLabel","promptPlaceholder","promptValue","title","content","image","onConfirm","onCancel","closeDialog","dialogId","dialog","document","getElementById","classList","remove","setTimeout","dialogBg","querySelector","options","_options","allOptions","dialogCount","querySelectorAll","baseZindex","createElement","add","dataset","for","style","zIndex","cancelButton","promptInput","id","innerHTML","body","append","addEventListener","e","preventDefault","thisId","currentTarget","closest","val","value","undefined","prompt","confirm","alert","markupDetect","window","form","markupVersion","parseInt","isLegacyMode","imageChoicesVars","useNewFeatures","formHasImageChoicesFields","hasImageChoicesFields","each","fields","field","imageChoices_enableImages","markup","removeChoicesButton","imageChoicesFieldStrings","removeAllChoices","choicesAdminRow","index","img","uploadImage","removeImage","join","choicesPreviewRow","labelText","getChoices","GetSelectedField","getSettingsElement","find","$row","this","data","choices","imageChoices_image","imgID","imageChoices_imageID","$firstInput","before","addClass","updateFieldPreview","RemovePreview","btnEl","$choice","css","removeClass","UpdateFieldChoicesObject","imageID","onProductPriceChange","$field","productImageField","type","inputType","$label","$imageWrap","imagesEnabled","hasProductImage","detach","productImage_image","basePrice","prepend","html","imageChoices_showLabels","toggleShowLabels","$fieldChoices","hasClass","getField","trigger","$settingsWrap","isColorPickerPluginActive","colorPickerFieldVars","isImageChoicesEnabled","fieldCanHaveImages","hasImageChoicesImage","isProductImageField","isProductImageEnabled","productImage_enabled","hasProductImageId","productImage_imageId","onProductImageToggleClick","toggle","toggleEnableImages","checked","click","enable","forProductImage","isForProductImage","toggleSelector","$settings","$toggle","is","onToggleEnableImages","$coloPickerToggle","confirmImagesToggle","colorPicker_toggleEnableColors","imageChoices_toggleEnableImages","toggleClass","SetFieldProperty","choicesContainerSelector","toLowerCase","$removeChoicesBtn","$enableOtherChoicesSetting","show","toggleShowPrices","toggleUseLightboxCaption","toggleUseLightbox","lightboxCaptionSelector","useLightboxWarning","fieldChoice","hasImage","hasImageID","setProperty","updateEntrySetting","selectorPrefix","OpenMediaLibrary","image_fileFrame","open","wp","media","button","text","frame","state","multiple","jQuery","on","selection","get","attachment","first","display","toJSON","sizes","size","unshift","imageSize","url","updateProductImage","$choicesFlyout","canHave","gform","applyFilters","fieldSettingsSelector","previewHeight","$el","height","outerHeight","updateThemeSetting","$previewImg","$previewWrap","hide","gf_image_choices_theme","globals","theme","defaults","updateFeatureColorSetting","$customColorLabel","$customColorInput","$customColorPicker","customColor","wpColorPicker","change","ui","updateCustomFeatureColor","color","propPrefix","updateAlignSetting","updateImageStyleSetting","validateNumericValue","numVal","trim","num","isNaN","updateColumnsSetting","updateColumnsWidthSetting","updateColumnsMediumSetting","updateColumnsMediumWidthSetting","updateColumnsSmallSetting","updateColumnsSmallWidthSetting","updateHeightSetting","updateMediumHeightSetting","updateSmallHeightSetting","initProductImageField","initImageChoicesField","skipImageChoicesFieldAlert","formEditorInit","parseFloat","gf_version","event","ajax","ajaxurl","method","action","skip","addAction","fieldId","forEach","f","$fieldSettings","productImageEnabled","productImageUrl","productImageId","useProductImageLightbox","productImage_useLightbox","selectedProductImageTheme","productImage_theme","productImageStyle","productImage_imageStyle","productImageUseLightboxCaption","productImage_useLightboxCaption","productImageHeightSetting","productImage_height","productImageMediumHeightSetting","productImage_heightMedium","productImageSmallHeightSetting","productImage_heightSmall","productImageEntryValue","productImage_entrySetting","useLightbox","imageChoices_useLightbox","displayLabels","showPrices","imageChoices_showPrices","entryValue","imageChoices_entrySetting","selectedTheme","imageChoices_theme","featureColor","imageChoices_featureColor","featureColorCustom","imageChoices_featureColorCustom","alignSetting","imageChoices_align","imageStyle","imageChoices_imageStyle","columnsSetting","imageChoices_columns","columnsWidthSetting","imageChoices_columnsWidth","columnsMediumSetting","imageChoices_columnsMedium","columnsMediumWidthSetting","imageChoices_columnsWidthMedium","columnsSmallSetting","imageChoices_columnsSmall","columnsSmallWidthSetting","imageChoices_columnsWidthSmall","useLightboxCaption","imageChoices_useLightboxCaption","heightSetting","imageChoices_height","mediumHeightSetting","imageChoices_heightMedium","smallHeightSetting","imageChoices_heightSmall","bind","imageChoices_GF_UpdateFieldChoices","UpdateFieldChoices","apply","formEditorLegacyWarning","adminInit","$customCssBoxes","editorSettings","codeEditor","defaultSettings","_","clone","codemirror","indentUnit","tabSize","mode","lineNumbers","autoCloseBrackets","continueComments","indentWithTabs","inputStyle","lineWrapping","lint","matchBrackets","styleActiveLine","gutters","extraKeys","initialize","$legacyCssSectionToggle","ref","attr","refresh","$legacyModeToggle","$newFeaturesElements","useLegacyMode","$settingsTabNavLinks","location","hash","replace","substring","hashTab","dispatchEvent","Event","$numericSettingsInputs","$settingsThemeSelect","$settingsThemePreview","settingsCustomFeatureColor","$settingsFeatureColorPicker","$settingsFeatureColorSelect","$settingsFeatureColorCustom","$settingsFeatureColorInput","$urlReplacementTool","$urlReplacementSubmit","$urlReplacementProgress","$urlReplacementProgressBar","$urlReplacementStatus","urlReplacements","old","new","forms","replacements","processUrlReplacement","$sizeReplacementTool","beforeSend","jqXHR","settings","success","response","total","error","Math","ceil","formId","oldUrl","newUrl","form_id","$sizeReplacementSubmit","$sizeReplacementProgress","$sizeReplacementProgressBar","$sizeReplacementStatus","sizeReplacements","processSizeReplacement","newSize","gformAdminReadyCheck","gformAdminReady","ready","setInterval","clearInterval"],"sources":["gf_image_choices_admin.js"],"sourcesContent":["var imageChoicesAdmin = imageChoicesAdmin || {};\n\n(function($){\n\n\tvar GF_MARKUP_VERSION = 2;\n\n\timageChoicesAdmin.extend = (...arguments) => {\n\n\t\t// Variables\n\t\tlet extended = {};\n\t\tlet deep = false;\n\t\tlet i = 0;\n\n\t\t// Check if a deep merge\n\t\tif (typeof (arguments[0]) === 'boolean') {\n\t\t\tdeep = arguments[0];\n\t\t\ti++;\n\t\t}\n\n\t\t// Merge the object into the extended object\n\t\tlet merge = function (obj) {\n\t\t\tfor (let prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\t\t\t\t\t\t// If we're doing a deep merge and the property is an object\n\t\t\t\t\t\textended[prop] = imageChoicesAdmin.extend(true, extended[prop], obj[prop]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Otherwise, do a regular merge\n\t\t\t\t\t\textended[prop] = obj[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Loop through each object and conduct a merge\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tmerge(arguments[i]);\n\t\t}\n\n\t\treturn extended;\n\n\t};\n\n\timageChoicesAdmin.__dialogDefaults = {\n\t\tdialogType: 'alert',\n\t\tcancelText: 'Cancel',\n\t\tconfirmText: 'Ok',\n\t\tallowCancel: true,\n\t\tpromptLabel: '',\n\t\tpromptPlaceholder: '',\n\t\tpromptValue: '',\n\t\ttitle: '',\n\t\tcontent: '',\n\t\timage: false,\n\t\tonConfirm: null,\n\t\tonCancel: null,\n\t};\n\n\timageChoicesAdmin.closeDialog = (dialogId) => {\n\t\tlet dialog = document.getElementById(dialogId);\n\t\tif ( dialog ) {\n\t\t\tdialog.classList.remove('ic-active');\n\t\t\tsetTimeout(() => {\n\t\t\t\tdialog.remove();\n\t\t\t}, 300);\n\t\t}\n\t\tlet dialogBg = document.querySelector(`.ic-dialog-bg[data-for=\"${dialogId}\"]`);\n\t\tif ( dialogBg ) {\n\t\t\tdialogBg.classList.remove('ic-active');\n\t\t\tsetTimeout(() => {\n\t\t\t\tdialogBg.remove();\n\t\t\t}, 300);\n\t\t}\n\t};\n\n\timageChoicesAdmin.dialog = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\tif ( allOptions.dialogType !== 'alert' && allOptions.dialogType !== 'confirm' && allOptions.dialogType !== 'prompt' ) {\n\t\t\tallOptions.dialogType = imageChoicesAdmin.__dialogDefaults.dialogType;\n\t\t}\n\t\tif ( allOptions.dialogType === 'alert' ) {\n\t\t\tallOptions.allowCancel = false;\n\t\t}\n\n\t\tlet dialogCount = document.querySelectorAll('.ic-dialog').length;\n\t\tlet dialogId = `ic_dialog_${dialogCount}`;\n\n\t\tlet baseZindex = 999900;\n\n\t\tlet dialogBg = document.createElement('div');\n\t\tdialogBg.classList.add('ic-dialog-bg');\n\t\tdialogBg.dataset.for = dialogId;\n\t\tdialogBg.style.zIndex = `${baseZindex + dialogCount}`;\n\n\t\tlet cancelButton = ( allOptions.allowCancel ) ? `<button type=\"button\" class=\"ic-btn ic-btn-secondary ic-dialog-cancel\">${allOptions.cancelText}</button>` : ``;\n\n\t\tlet promptLabel = ( allOptions.promptLabel ) ? `<label for=\"${dialogId}_input\" class=\"ic-prompt-input-label\">${allOptions.promptLabel}</label>` : ``;\n\t\tlet promptInput = ( allOptions.dialogType === 'prompt' ) ? `<div class=\"ic-prompt-input-wrap\">${promptLabel}<input type=\"text\" id=\"${dialogId}_input\" class=ic-prompt-input\" value=\"${allOptions.promptValue}\" placeholder=\"${allOptions.promptPlaceholder}\"></div>` : ``;\n\n\t\tlet dialog = document.createElement('div');\n\t\tdialog.id = dialogId;\n\t\tdialog.classList.add('ic-dialog', `ic-dialog-${allOptions.dialogType}`);\n\t\tdialog.innerHTML = `<div class=\"ic-dialog-header\">${allOptions.title}</div><div class=\"ic-dialog-body\">${allOptions.content}${promptInput}</div><div class=\"ic-dialog-footer\">${cancelButton}<button type=\"button\" class=\"ic-btn ic-dialog-confirm\">${allOptions.confirmText}</button></div>`;\n\t\tdialog.style.zIndex = `${baseZindex + dialogCount + 1}`;\n\n\t\tdocument.body.append(dialogBg);\n\t\tdocument.body.append(dialog);\n\t\tsetTimeout(() => {\n\t\t\tdialogBg.classList.add('ic-active');\n\t\t\tdialog.classList.add('ic-active');\n\t\t}, 10);\n\n\t\tdialog.querySelector('.ic-dialog-confirm').addEventListener('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tlet thisId =  e.currentTarget.closest('.ic-dialog').id;\n\t\t\tif ( typeof allOptions.onConfirm === 'function' ) {\n\t\t\t\tlet val = ( allOptions.dialogType === 'prompt' ) ? document.getElementById(`${thisId}_input`).value : undefined;\n\t\t\t\tallOptions.onConfirm(val);\n\t\t\t}\n\t\t\timageChoicesAdmin.closeDialog( thisId );\n\t\t});\n\n\t\tif ( allOptions.allowCancel ) {\n\t\t\tdialog.querySelector('.ic-dialog-cancel').addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tif ( typeof allOptions.onCancel === 'function' ) {\n\t\t\t\t\tallOptions.onCancel();\n\t\t\t\t}\n\t\t\t\timageChoicesAdmin.closeDialog( e.currentTarget.closest('.ic-dialog').id );\n\t\t\t});\n\t\t}\n\t};\n\n\timageChoicesAdmin.prompt = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tif (typeof options !== \"object\") {\n\t\t\toptions = {};\n\t\t}\n\t\toptions.dialogType = 'prompt';\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\timageChoicesAdmin.dialog(allOptions);\n\t};\n\n\timageChoicesAdmin.confirm = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tif (typeof options !== \"object\") {\n\t\t\toptions = {};\n\t\t}\n\t\toptions.dialogType = 'confirm';\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\timageChoicesAdmin.dialog(allOptions);\n\t};\n\n\timageChoicesAdmin.alert = (options) => {\n\t\tlet _options = imageChoicesAdmin.__dialogDefaults;\n\t\tif (typeof options !== \"object\") {\n\t\t\toptions = {};\n\t\t}\n\t\toptions.dialogType = 'alert';\n\t\tlet allOptions = (typeof options === \"object\") ? imageChoicesAdmin.extend(true, _options, options) : _options;\n\t\timageChoicesAdmin.dialog(allOptions);\n\t};\n\n\n\timageChoicesAdmin.markupDetect = function() {\n\t\tif ( typeof window.form !== 'undefined' && window.form.hasOwnProperty('markupVersion') ) {\n\t\t\tGF_MARKUP_VERSION = ( window.form.markupVersion !== '' ) ? parseInt( window.form.markupVersion.toString(), 10 ) : 1;\n\t\t}\n\t\treturn GF_MARKUP_VERSION;\n\t};\n\n\timageChoicesAdmin.isLegacyMode = function() {\n\t\tvar useNewFeatures = ( imageChoicesVars.hasOwnProperty('useNewFeatures') && imageChoicesVars.useNewFeatures.toString() === 'true');\n\t\treturn !useNewFeatures;\n\t};\n\n\timageChoicesAdmin.formHasImageChoicesFields = function() {\n\t\tvar hasImageChoicesFields = false;\n\t\t$.each(window.form.fields, function(i, field){\n\t\t\tif ( field.hasOwnProperty('imageChoices_enableImages') && field.imageChoices_enableImages ) {\n\t\t\t\thasImageChoicesFields = true;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn hasImageChoicesFields;\n\t};\n\n\timageChoicesAdmin.markup = {\n\t\tremoveChoicesButton: function(){\n\t\t\treturn '<button class=\"button image-choices-remove-choices-btn\" type=\"button\" onclick=\"imageChoicesAdmin.removeAllChoices();\">'+imageChoicesFieldStrings.removeAllChoices+'</button>';\n\t\t},\n\t\tchoicesAdminRow: function(index, image, id){\n\t\t\tvar i = (index !== undefined) ? index : 0;\n\t\t\tvar img = (image !== undefined) ? image : '';\n\t\t\tvar id = (id !== undefined) ? id : '';\n\t\t\tvar buttonLabel = '<i class=\"ic-select-icon\"></i>';// GF 2.5+\n\t\t\treturn [\n\t\t\t\t'<button type=\"button\" id=\"image-choices-option-upload-button-'+i+'\" class=\"button image-choices-option-upload-button\" onclick=\"imageChoicesAdmin.OpenMediaLibrary(this);\" title=\"'+imageChoicesFieldStrings.uploadImage+'\">'+buttonLabel+'</button>',\n\t\t\t\t'<span id=\"image-choices-option-preview-'+i+'\" class=\"image-choices-option-preview-wrap\">',\n\t\t\t\t\t'<span class=\"image-choices-option-preview\" style=\"background-image:url('+img+');\"></span>',\n\t\t\t\t\t'<a href=\"javascript:void(0);\" class=\"image-choices-option-image-remove\" onclick=\"imageChoicesAdmin.RemovePreview(this);\" title=\"'+imageChoicesFieldStrings.removeImage+'\"><i class=\"dashicons dashicons-no\"></i></a>',\n\t\t\t\t'</span>',\n\t\t\t\t'<input type=\"hidden\" id=\"image-choices-option-image-'+i+'\" class=\"image-choices-option-image\" value=\"'+img+'\" />',\n\t\t\t\t'<input type=\"hidden\" id=\"image-choices-option-image-id-'+i+'\" class=\"image-choices-option-image-id\" value=\"'+id+'\" />'\n\t\t\t].join('');\n\t\t},\n\t\tchoicesPreviewRow: function(index, labelText, image) {\n\t\t\tvar i = (index !== undefined) ? index : 0;\n\t\t\tvar label = (labelText !== undefined) ? labelText : '';\n\t\t\tvar img = (image !== undefined) ? image : '';\n\t\t\treturn [\n\t\t\t\t'<span class=\"image-choices-choice-image-wrap\" style=\"background-image:url('+img+')\">',\n\t\t\t\t\t'<img src=\"'+img+'\" alt=\"\" class=\"image-choices-choice-image\" />',\n\t\t\t\t'</span>',\n\t\t\t\t'<span class=\"image-choices-choice-text\">'+label+'</span>'\n\t\t\t].join('');\n\t\t}\n\t};\n\n\timageChoicesAdmin.getChoices = function( field ) {\n\t\tif ( typeof field === 'undefined' ) {\n\t\t\tfield = GetSelectedField();\n\t\t}\n\n\t\tvar choicesSelector = '[class*=\"-choice-row\"]';\n\n\t\timageChoicesAdmin.getSettingsElement().find(choicesSelector).each(function(){\n\t\t\tvar $row = $(this);\n\t\t\tvar i = $row.data('index');\n\t\t\tvar img = (field.choices.length && field.choices[i].imageChoices_image !== undefined) ? field.choices[i].imageChoices_image : '';\n\t\t\tvar imgID = (field.choices.length && field.choices[i].imageChoices_imageID !== undefined) ? field.choices[i].imageChoices_imageID : '';\n\n\t\t\tif ( !$row.find('.image-choices-option-image').length ) {\n\t\t\t\tvar $firstInput = $row.find('input[id*=\"_choice_text\"]:first');\n\t\t\t\tif ( !$firstInput.length ) {\n\t\t\t\t\t$firstInput = $row.find('input[id*=\"-choice-text\"]:first');\n\t\t\t\t}\n\t\t\t\tif ( $firstInput.length ) {\n\t\t\t\t\t$firstInput.before(imageChoicesAdmin.markup.choicesAdminRow(i, img, imgID));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar $imageInput = $row.find('.image-choices-option-image');\n\t\t\tif ($imageInput.val() !== '') {\n\t\t\t\t$row.addClass('image-choices-has-image');\n\t\t\t}\n\t\t});\n\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.RemovePreview = function( btnEl ) {\n\t\tif (typeof btnEl === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $choice = $(btnEl).closest('[class*=\"-choice-row\"]');\n\t\t$choice.find('.image-choices-option-image').val('');\n\t\t$choice.find('.image-choices-option-image-id').val('');\n\t\t$choice.find('.image-choices-option-preview').css('background-image', '');\n\t\t$choice.removeClass('image-choices-has-image');\n\n\t\timageChoicesAdmin.UpdateFieldChoicesObject();\n\n\t\tvar field = GetSelectedField();\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.UpdateFieldChoicesObject = function() {\n\t\tvar field = GetSelectedField();\n\n\t\tvar $fieldSettings = imageChoicesAdmin.getSettingsElement();\n\n\t\tvar selector = '[class*=\"-choice-row\"]';\n\n\t\t$fieldSettings.find(selector).each(function(index) {\n\t\t\tvar $choice = $(this);\n\t\t\tvar image = $choice.find('.image-choices-option-image').val();\n\t\t\tvar imageID = $choice.find('.image-choices-option-image-id').val();\n\t\t\tvar i = $choice.data(\"index\");\n\t\t\tif (image !== '') {\n\t\t\t\t$choice.addClass('image-choices-has-image');\n\t\t\t\t$choice.find('.gf-image-choices-option-preview').css('background-image', 'url('+image+')');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$choice.removeClass('image-choices-has-image');\n\t\t\t}\n\t\t\tfield.choices[i].imageChoices_image = image;\n\t\t\tfield.choices[i].imageChoices_imageID = imageID;\n\t\t});\n\t};\n\n\timageChoicesAdmin.onProductPriceChange = function() {\n\t\tsetTimeout(function(){\n\t\t\timageChoicesAdmin.updateFieldPreview( GetSelectedField() );\n\t\t}, 10);\n\t};\n\n\timageChoicesAdmin.updateFieldPreview = function( field ) {\n\n\t\tvar $field = $('#field_'+field.id);\n\t\tvar productImageField = ( field.type === 'product' && field.inputType === 'singleproduct' );\n\n\t\tvar $label = $field.find('.gfield_label.gform-field-label');\n\t\tvar $imageWrap = $field.find('.ic-product-image-wrap');\n\n\t\tvar prop = productImageField ? 'productImage_enabled' : 'imageChoices_enableImages';\n\t\tvar imagesEnabled = (field.hasOwnProperty(prop) && field[prop] === true);\n\t\tvar hasProductImage = imageChoicesAdmin.hasProductImage( field );\n\n\t\tif ( !imagesEnabled ) {\n\t\t\tif ( $imageWrap.length ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif ( productImageField ) {\n\n\t\t\tif ( !$imageWrap.length && hasProductImage ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$imageWrap = $(`<div class=\"ic-product-image-wrap\"></div>`);\n\t\t\t\t$imageWrap.append(`<div class=\"ic-product-image\" style=\"background-image:url(${field.productImage_image});\"><img src=\"${field.productImage_image}\" alt=\"\" class=\"ic-product-image-element\" /></div>`);\n\t\t\t\t$imageWrap.append($label);\n\t\t\t\t$imageWrap.append(`<div class=\"ic-product-image-price\">${field.basePrice}</div>`);\n\t\t\t\t$field.prepend($imageWrap);\n\t\t\t}\n\t\t\telse if ( !hasProductImage && $imageWrap.length ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\n\t\t\tif ( hasProductImage ) {\n\t\t\t\t$field.find('.ic-product-image-price').html(field.basePrice);\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\tif ( $imageWrap.length ) {\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\n\t\t\tif ( imagesEnabled && field.imageChoices_showLabels === undefined ) {\n\t\t\t\timageChoicesAdmin.toggleShowLabels(true);\n\t\t\t}\n\n\t\t\t// inject the preview if not there\n\t\t\timageChoicesAdmin.$fieldChoices( $field ).each(function(i){\n\t\t\t\tvar $choice = $(this);\n\n\t\t\t\tif ( !$choice.hasClass('gchoice_total') ) {\n\n\t\t\t\t\t$choice.addClass('image-choices-choice');\n\n\t\t\t\t\tvar $label = $choice.find('label');\n\t\t\t\t\tvar labelText = ($label.find('.image-choices-choice-text').length) ? $label.find('.image-choices-choice-text').html() : $label.html();\n\n\t\t\t\t\tif (field.imageChoices_enableImages) {\n\t\t\t\t\t\tif (field.choices.length > i) {\n\t\t\t\t\t\t\tvar img = (field.choices[i].imageChoices_image !== undefined) ? field.choices[i].imageChoices_image : '';\n\t\t\t\t\t\t\t$label.html(imageChoicesAdmin.markup.choicesPreviewRow(i, labelText, img));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$label.html(labelText);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.getField = function() {\n\t\tvar field = GetSelectedField();\n\t\treturn $('#field_'+field.id);\n\t};\n\n\timageChoicesAdmin.removeAllChoices = function() {\n\t\timageChoicesAdmin.getSettingsElement().find('.image-choices-option-image-remove').each(function(){\n\t\t\t$(this).trigger('click');\n\t\t});\n\n\t\t$settingsWrap.find('.gf_delete_field_choice').each(function(){\n\t\t\t$(this).trigger('click');\n\t\t});\n\n\t\t$settingsWrap.find('.field-choice-row input[type=\"text\"], .gquiz-choice-row input[type=\"text\"]').val('');\n\t};\n\n\timageChoicesAdmin.isColorPickerPluginActive = function() {\n\t\treturn (window.hasOwnProperty('colorPickerFieldVars') && typeof window.colorPickerFieldVars !== 'undefined');\n\t};\n\n\timageChoicesAdmin.isImageChoicesEnabled = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.fieldCanHaveImages(field) && field.imageChoices_enableImages === true );\n\t};\n\n\timageChoicesAdmin.hasImageChoicesImage = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isImageChoicesEnabled(field) && field.hasOwnProperty('imageChoices_image') && field.imageChoices_image !== '' );\n\t};\n\n\timageChoicesAdmin.isProductImageField = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( field.type === \"product\" && field.inputType === \"singleproduct\" );\n\t};\n\n\timageChoicesAdmin.isProductImageEnabled = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.productImage_enabled === true );\n\t};\n\n\timageChoicesAdmin.hasProductImage = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.hasOwnProperty('productImage_image') && field.productImage_image !== '' );\n\t};\n\n\timageChoicesAdmin.hasProductImageId = function( field ) {\n\t\tfield = field || GetSelectedField();\n\t\treturn ( imageChoicesAdmin.isProductImageField(field) && field.hasOwnProperty('productImage_imageId') && field.productImage_imageId );\n\t};\n\n\timageChoicesAdmin.onProductImageToggleClick = function(toggle) {\n\t\timageChoicesAdmin.toggleEnableImages(toggle.checked, true);\n\t\tif ( toggle.checked ) {\n\t\t\tif ( !imageChoicesAdmin.hasProductImage() ) {\n\t\t\t\t$('#product_image_tab_toggle').click();\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t$('#product-image-button').click();\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t}\n\t}\n\n\timageChoicesAdmin.toggleEnableImages = function( enable, forProductImage ) {\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.field_product_image_enabled' : 'input.field_choice_images_enabled';\n\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $toggle = $settings.find(toggleSelector);\n\n\t\tif ( enable === undefined ) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tif ( isForProductImage ) {\n\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t\treturn;\n\t\t}\n\n\t\tvar $coloPickerToggle = $settings.find('input.field_color_picker_enabled');\n\n\t\t// if user is enabling image choices, and color picker is currently in use on this field, confirm the switch\n\t\tif (enable && imageChoicesAdmin.isColorPickerPluginActive() && $coloPickerToggle.length && $coloPickerToggle.is(':checked')) {\n\t\t\tif (window.confirm(imageChoicesFieldStrings.confirmImagesToggle)) {\n\t\t\t\tif (window.hasOwnProperty('colorPicker_toggleEnableColors') && typeof window.colorPicker_toggleEnableColors === 'function') {\n\t\t\t\t\twindow.colorPicker_toggleEnableColors(false);\n\t\t\t\t}\n\t\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$toggle.prop('checked', false);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\timageChoicesAdmin.onToggleEnableImages(enable, isForProductImage);\n\t\t}\n\t};\n\twindow.imageChoices_toggleEnableImages = imageChoicesAdmin.toggleEnableImages;// legacy support\n\n\timageChoicesAdmin.onToggleEnableImages = function( enable, forProductImage ) {\n\n\t\tvar field = GetSelectedField();\n\t\tif ( !field ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.field_product_image_enabled' : 'input.field_choice_images_enabled';\n\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $toggle = $settings.find(toggleSelector);\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$field.toggleClass('image-choices-admin-field', enable);\n\t\t//$fieldSettings.toggleClass('image-choices-product-field', field.type === \"product\");\n\n\t\tif ( isForProductImage ) {\n\n\t\t\tSetFieldProperty('productImage_enabled', enable);\n\t\t\t$toggle.prop('checked', enable);\n\t\t\t$('#product_image_tab_toggle').toggle( enable );\n\n\t\t\tvar $imageWrap = $field.find('.ic-product-image-wrap');\n\n\t\t\tif ( !enable && $imageWrap.length ) {\n\t\t\t\tvar $label = $field.find('.gfield_label.gform-field-label');\n\t\t\t\t$label.detach();\n\t\t\t\t$field.prepend($label);\n\t\t\t\t$imageWrap.remove();\n\t\t\t}\n\n\t\t\t$field.toggleClass('product-image-admin-field', enable);\n\t\t\t$field.toggleClass('product-image-enabled', enable);\n\t\t\t$settings.toggleClass('product-image-enabled', enable);\n\n\t\t}\n\t\telse {\n\n\t\t\tSetFieldProperty('imageChoices_enableImages', enable);\n\t\t\t$toggle.prop('checked', enable);\n\t\t\t$('#image_choices_tab_toggle').toggle( enable );\n\n\t\t\tvar choicesContainerSelector = ( field.type.toLowerCase() === \"quiz\" ) ? '#gquiz_gfield_settings_choices_container' : '#gfield_settings_choices_container';\n\t\t\tvar $choicesContainer = $(choicesContainerSelector);\n\t\t\t$choicesContainer.toggleClass('image-choices-enabled', enable);\n\n\t\t\t$field.toggleClass('image-choices-use-images', enable);\n\t\t\t$settings.toggleClass('image-choices-use-images', enable);\n\n\t\t\tvar $removeChoicesBtn = $settings.find('.image-choices-remove-choices-btn');\n\n\t\t\tif (!enable) {\n\t\t\t\tif ($removeChoicesBtn.length) {\n\t\t\t\t\t$removeChoicesBtn.remove();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar $enableOtherChoicesSetting = $('.field_setting.other_choice_setting');\n\t\t\tvar isFieldWithOtherChoiceOption = (field.type === 'radio' || (field.type === 'poll' && field.inputType === 'radio'));\n\n\t\t\tif (isFieldWithOtherChoiceOption) {\n\t\t\t\t$enableOtherChoicesSetting.show();\n\t\t\t}\n\n\t\t}\n\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.toggleShowLabels = function( enable ) {\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find('input.image_choices_show_labels');\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tSetFieldProperty('imageChoices_showLabels', enable);\n\n\t\t$toggle.prop('checked', enable);\n\n\t\t$field.toggleClass('image-choices-show-labels', enable);\n\t};\n\n\timageChoicesAdmin.toggleShowPrices = function( enable ) {\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find('input.image_choices_show_prices');\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\tSetFieldProperty('imageChoices_showPrices', enable);\n\n\t\t$toggle.prop('checked', enable);\n\n\t\t$field.toggleClass('image-choices-show-prices', enable);\n\t};\n\n\timageChoicesAdmin.toggleUseLightboxCaption = function( enable, forProductImage ) {\n\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.product_image_use_lightbox_caption' : 'input.image_choices_use_lightbox_caption';\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find(toggleSelector);\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$toggle.prop('checked', enable);\n\n\t\tif ( isForProductImage ) {\n\t\t\tSetFieldProperty('productImage_useLightboxCaption', enable);\n\t\t}\n\t\telse {\n\t\t\tSetFieldProperty('imageChoices_useLightboxCaption', enable);\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.toggleUseLightbox = function( enable, forProductImage ) {\n\n\t\tvar field = GetSelectedField();\n\t\tvar $field = imageChoicesAdmin.getField();\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar toggleSelector = isForProductImage ? 'input.product_image_use_lightbox' : 'input.image_choices_use_lightbox';\n\t\tvar $toggle = imageChoicesAdmin.getSettingsElement().find(toggleSelector);\n\t\tvar lightboxCaptionSelector = isForProductImage ? '.product-image-setting-use-lightbox-caption' : '.image-choices-setting-use-lightbox-caption';\n\n\t\tif (enable === undefined) {\n\t\t\tenable = $toggle.is(':checked');\n\t\t}\n\n\t\t$toggle.prop('checked', enable);\n\n\t\tif ( isForProductImage ) {\n\n\t\t\tSetFieldProperty('productImage_useLightbox', enable);\n\t\t\t$field.toggleClass('product-image-use-lightbox', enable);\n\n\t\t\tif ( imageChoicesAdmin.hasProductImage(field) && !imageChoicesAdmin.hasProductImageId(field) ) {\n\t\t\t\twindow.alert(imageChoicesFieldStrings.useLightboxWarning);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\tSetFieldProperty('imageChoices_useLightbox', enable);\n\t\t\t$field.toggleClass('image-choices-use-lightbox', enable);\n\n\t\t\tif (enable) {\n\t\t\t\t$.each(field.choices, function(i, fieldChoice){\n\t\t\t\t\tvar hasImage = ( fieldChoice.hasOwnProperty('imageChoices_image') && fieldChoice.imageChoices_image !== '' );\n\t\t\t\t\tvar hasImageID = ( fieldChoice.hasOwnProperty('imageChoices_imageID') && fieldChoice.imageChoices_imageID !== '' );\n\n\t\t\t\t\tif ( hasImage && !hasImageID ) {\n\t\t\t\t\t\twindow.alert(imageChoicesFieldStrings.useLightboxWarning);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\n\t\tdocument.querySelector(lightboxCaptionSelector).style.setProperty('display', enable ? 'block' : 'none', 'important');\n\n\t};\n\n\timageChoicesAdmin.updateEntrySetting = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty(`${propPrefix}_entrySetting`, value);\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-entry-value`).val( value );\n\t};\n\n\timageChoicesAdmin.OpenMediaLibrary = function( btnEl ) {\n\t\tif (typeof btnEl === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tvar field = GetSelectedField();\n\t\tvar isForProductImage = imageChoicesAdmin.isProductImageField(field);\n\n\t\tvar image_fileFrame;\n\n\t\tif ( isForProductImage ) {\n\t\t\tvar $field = imageChoicesAdmin.getField();\n\t\t\timage_fileFrame = $field.data('file-frame');\n\t\t}\n\t\telse {\n\t\t\tvar $choice = $(btnEl).closest('[class*=\"-choice-row\"]');\n\t\t\timage_fileFrame = $choice.data('file-frame');\n\t\t}\n\n\t\t// If the media frame already exists, reopen it.\n\t\tif ( image_fileFrame ) {\n\t\t\t// Open frame\n\t\t\timage_fileFrame.open();\n\t\t\treturn;\n\t\t}\n\n\t\t// Create the media frame.\n\t\timage_fileFrame = wp.media({\n\t\t\ttitle: 'Select an image to upload',\n\t\t\tbutton: {\n\t\t\t\ttext: 'Use this image'\n\t\t\t},\n\t\t\tframe: 'post',\n\t\t\tstate: 'insert',\n\t\t\tmultiple: false\t// Set to true to allow multiple files to be selected\n\t\t});\n\n\t\tsetTimeout(function(){\n\t\t\t$('input[value=\"Insert into Post\"]').val('Use this Image');\n\t\t\t$('button.media-button-insert').text('Use this Image');\n\t\t}, 100);\n\n\t\tjQuery('body').on('click', 'li.attachment', function(){\n\t\t\t$('input[value=\"Insert into Post\"]').val('Use this Image');\n\t\t\t$('button.media-button-insert').text('Use this Image');\n\t\t});\n\n\t\t// When an image is selected, run a callback.\n\t\timage_fileFrame.on( 'insert', function(selection) {\n\t\t\tvar state = image_fileFrame.state();\n\t\t\tselection = selection || state.get('selection');\n\t\t\tif (! selection) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar attachment = selection.first();\n\t\t\tvar selectedSize = \"\";\n\n\t\t\tvar display = state.display(attachment).toJSON();\n\t\t\tattachment = attachment.toJSON();\n\n\t\t\t// start with the selected size, but fallback to one of the defaults if there's no image\n\t\t\t// this can happen eg when there are existing images in the media library when a new size is created, and thumbnails haven't been generated for existing\n\t\t\t// the size will appear as an option in the media library when selecting the image, but then fails as there's no image in that size\n\t\t\tvar sizes = [\"medium\", \"thumbnail\", \"full\"];\n\t\t\tif ( display && display.hasOwnProperty('size') && display.size ) {\n\t\t\t\tsizes.unshift( display.size );\n\t\t\t}\n\n\t\t\tvar img;\n\t\t\tif ( !attachment.hasOwnProperty('sizes') ) {\n\t\t\t\timg = attachment.url;\n\t\t\t\tselectedSize = \"full\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar i = 0;\n\t\t\t\tvar imageSize = sizes[i].toString();\n\t\t\t\twhile ( !attachment.sizes.hasOwnProperty(imageSize) || !attachment.sizes[imageSize].hasOwnProperty('url') || attachment.sizes[imageSize].url === \"\" ) {\n\t\t\t\t\ti++;\n\t\t\t\t\timageSize = sizes[i].toString();\n\t\t\t\t}\n\t\t\t\timg = attachment.sizes[imageSize].url;\n\t\t\t\tselectedSize = imageSize;\n\t\t\t\t// TODO: size override? But can use the IC image size update tool\n\t\t\t\t/*\n\t\t\t\tif ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('imageSize') && sizes.indexOf(imageChoicesVars.defaults.imageSize) !== -1 ) {\n\t\t\t\t\timg = attachment.sizes[imageChoicesVars.defaults.imageSize].url;\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\n\t\t\tif ( isForProductImage ) {\n\t\t\t\timageChoicesAdmin.updateProductImage(img, attachment.id);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$choice.find('.image-choices-option-image').val(img);\n\t\t\t\t$choice.find('.image-choices-option-image-id').val(attachment.id);\n\t\t\t\t$choice.find('.image-choices-option-preview').css('background-image', 'url('+img+')');\n\t\t\t\t$choice.addClass('image-choices-has-image');\n\n\t\t\t\timageChoicesAdmin.UpdateFieldChoicesObject();\n\t\t\t\timageChoicesAdmin.updateFieldPreview(field);\n\n\t\t\t\t// GF 2.6+\n\t\t\t\tvar $choicesFlyout = $('#choices-ui-flyout');\n\t\t\t\tif ( $choicesFlyout.length ) {\n\t\t\t\t\t$choicesFlyout.addClass('gform-flyout--anim-in-ready gform-flyout--anim-in-active');\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\t// Finally, open the modal\n\t\timage_fileFrame.open();\n\n\t\tif ( isForProductImage ) {\n\t\t\t$field.data('file-frame', image_fileFrame);\n\t\t}\n\t\telse {\n\t\t\t$choice.data('file-frame', image_fileFrame);\n\t\t}\n\t};\n\n\timageChoicesAdmin.fieldCanHaveImages = function( field ) {\n\n\t\tif ( typeof field === 'undefined' || !field.hasOwnProperty('type') ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar canHave = (\n\t\t\tfield.type === 'radio'\n\t\t\t|| field.type === 'checkbox'\n\t\t\t|| ( field.type === 'quiz' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'quiz' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'poll' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'poll' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'post_custom_field' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'post_custom_field' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'survey' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'survey' && field.inputType == 'checkbox' )\n\t\t\t|| ( field.type === 'product' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'shipping' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'option' && field.inputType == 'radio' )\n\t\t\t|| ( field.type === 'option' && field.inputType == 'checkbox' )\n\t\t);\n\n\t\treturn gform.applyFilters('gfic_field_can_have_images', canHave, field);\n\n\t};\n\n\timageChoicesAdmin.$fieldChoices = function( $field ) {\n\t\tif ( typeof $field === 'undefined' || $field instanceof jQuery === false) {\n\t\t\treturn [];\n\t\t}\n\t\tvar choicesSelector = '.ginput_container .gfield_radio div[class*=\"gchoice\"], .ginput_container .gfield_checkbox .gchoice:not(.gchoice_select_all)';// GF 2.5+\n\n\t\treturn $field.find(choicesSelector);\n\t};\n\n\timageChoicesAdmin.getSettingsElement = function() {\n\t\tvar fieldSettingsSelector = '#field_settings_container';// GF 2.5+\n\n\t\tvar field = GetSelectedField();\n\t\tfieldSettingsSelector += ( field.type === \"quiz\" ) ? ', #gquiz_gfield_settings_choices_container' : ', #gfield_settings_choices_container'\n\n\t\treturn $(fieldSettingsSelector);\n\t};\n\n\timageChoicesAdmin.previewHeight = function( $el ) {\n\n\t\tif ( typeof $el !== 'object' ) {\n\t\t\tvar $field = imageChoicesAdmin.getField();\n\t\t\t$el = $field.find('.ginput_container');\n\t\t}\n\n\t\tif ( !$el.length || !$el.closest('.gfield').hasClass('image-choices-admin-field') ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(function(){\n\t\t\t$el.height( $el.find('> ul:first').outerHeight() );\n\t\t}, 20);\n\n\t};\n\n\timageChoicesAdmin.updateProductImage = function( url, id ) {\n\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\tvar $field = imageChoicesAdmin.getField();\n\n\t\tif ( typeof url === 'undefined' ) {\n\t\t\turl = '';\n\t\t}\n\t\tif ( typeof id === 'undefined' ) {\n\t\t\tid = '';\n\t\t}\n\n\t\tSetFieldProperty('productImage_image', url);\n\t\tSetFieldProperty('productImage_imageId', id);\n\n\t\t$settings.find('.product-image-url').val(url);\n\t\t$settings.find('.product-image-id').val(id);\n\t\t$settings.find('#product-image-preview').css('background-image', 'url('+url+')');\n\n\t\t$settings.toggleClass('has-product-image', url !== '');// todo: class on settings?\n\t\t$field.toggleClass('has-product-image', url !== '');// todo: or class on field?\n\t\timageChoicesAdmin.updateFieldPreview( GetSelectedField() );\n\n\t};\n\n\timageChoicesAdmin.updateThemeSetting = function( value, forProductImage ) {\n\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_theme`, value );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-theme`).val( value );\n\n\t\tvar $previewWrap = $(`#${selectorPrefix}-theme-preview`);\n\t\tvar $previewImg;\n\t\t$previewWrap.toggle(value !== 'none');\n\t\tif (value === 'none') {\n\t\t\t$previewWrap.hide().find('img').hide();\n\t\t}\n\t\telse if (value === 'form_setting') {\n\t\t\tvalue = (window.form.hasOwnProperty('gf-image-choices') && window.form['gf-image-choices'].hasOwnProperty('gf_image_choices_theme')) ? window.form['gf-image-choices'].gf_image_choices_theme : '';\n\t\t\tif ( !value || value === \"global_setting\" ) {\n\t\t\t\tvalue = ( imageChoicesVars.hasOwnProperty('globals') && imageChoicesVars.globals.hasOwnProperty('theme') ) ? imageChoicesVars.globals.theme : ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('theme') ) ? imageChoicesVars.defaults.theme : 'simple';\n\t\t\t}\n\t\t\t$previewWrap.find('img').hide();\n\t\t\t$previewImg = $previewWrap.find(`img.${selectorPrefix}-theme-preview-${value}`);\n\t\t\tif ( $previewImg.length ) {\n\t\t\t\t$previewImg.show();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t$previewWrap.find('img').hide();\n\t\t\t$previewImg = $previewWrap.find(`img.${selectorPrefix}-theme-preview-${value}`);\n\t\t\tif ( $previewImg.length ) {\n\t\t\t\t$previewImg.show();\n\t\t\t}\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.updateFeatureColorSetting = function( value ) {\n\n\t\tSetFieldProperty( `imageChoices_featureColor`, value );\n\n\t\tvar $customColorLabel = imageChoicesAdmin.getSettingsElement().find(`[for=\"image-choices-feature-color-custom\"]`);\n\t\tvar $customColorInput = imageChoicesAdmin.getSettingsElement().find(`#image-choices-feature-color-custom`);\n\t\tvar $customColorPicker = imageChoicesAdmin.getSettingsElement().find(`.image-choices-setting-feature-color .wp-picker-container`);\n\t\tvar customColor = $customColorInput.val();\n\n\t\timageChoicesAdmin.getSettingsElement().find(`#image-choices-feature-color`).val( value );\n\n\t\tif ( value === \"custom\" ) {\n\t\t\t$customColorLabel.show();\n\t\t\t$customColorInput.show();\n\t\t\tif ( $customColorPicker.length ) {\n\t\t\t\t$customColorPicker.show();\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t$customColorInput.wpColorPicker('color', customColor);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$customColorInput.wpColorPicker({\n\t\t\t\t\tchange: function( e, ui ) {\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor( ui.color.toString() );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t$customColorInput.wpColorPicker('color', customColor);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t$customColorLabel.hide();\n\t\t\t$customColorInput.hide();\n\t\t\tif ( $customColorPicker.length ) {\n\t\t\t\t$customColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t$customColorPicker.hide();\n\t\t\t}\n\t\t}\n\n\t};\n\n\timageChoicesAdmin.updateCustomFeatureColor = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-feature-color-custom`).val( value );\n\t\tSetFieldProperty( `${propPrefix}_featureColorCustom`, value );\n\t};\n\n\timageChoicesAdmin.updateAlignSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_align', value );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-align').val( value );\n\t};\n\n\timageChoicesAdmin.updateImageStyleSetting = function( value, forProductImage ) {\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\t\tSetFieldProperty( `${propPrefix}_imageStyle`, value );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-image-style`).val( value );\n\t};\n\n\timageChoicesAdmin.validateNumericValue = function( val ) {\n\t\tvar numVal = '';\n\t\tval = val.toString();\n\t\tif ( val.trim() !== '' ) {\n\t\t\tvar num = parseInt(val, 10);\n\t\t\tif ( isNaN(num) || num <= 0 ) {\n\t\t\t\tnumVal = '';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnumVal = num.toString();\n\t\t\t}\n\t\t}\n\t\treturn ( numVal !== val ) ? numVal : val;\n\t};\n\n\timageChoicesAdmin.updateColumnsSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columns', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidth', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateColumnsMediumSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columnsMedium', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns-medium').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width-medium').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsMediumWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidthMedium', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width-medium').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateColumnsSmallSetting = function( value ) {\n\t\tSetFieldProperty( 'imageChoices_columnsSmall', value );\n\t\tvar $settings = imageChoicesAdmin.getSettingsElement();\n\t\t$settings.find('#image-choices-columns-small').val( value );\n\t\t$settings.find('.image-choices-setting-columns-width-small').toggle( value === 'fixed' );\n\t};\n\n\timageChoicesAdmin.updateColumnsSmallWidthSetting = function( value ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tSetFieldProperty( 'imageChoices_columnsWidthSmall', numVal );\n\t\timageChoicesAdmin.getSettingsElement().find('#image-choices-columns-width-small').val( numVal );\n\t};\n\n\timageChoicesAdmin.updateHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_height`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height`).val( numVal );\n\t};\n\n\timageChoicesAdmin.updateMediumHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_heightMedium`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height-medium`).val( numVal );\n\t};\n\n\timageChoicesAdmin.updateSmallHeightSetting = function( value, forProductImage ) {\n\t\tvar numVal = imageChoicesAdmin.validateNumericValue( value );\n\t\tvar isForProductImage = ( forProductImage === true );\n\t\tvar propPrefix = isForProductImage ? 'productImage' : 'imageChoices';\n\t\tvar selectorPrefix = isForProductImage ? 'product-image' : 'image-choices';\n\n\t\tSetFieldProperty( `${propPrefix}_heightSmall`, numVal );\n\t\timageChoicesAdmin.getSettingsElement().find(`#${selectorPrefix}-height-small`).val( numVal );\n\t};\n\n\timageChoicesAdmin.initProductImageField = function(field) {\n\t\tvar $field = $('#field_'+field.id);\n\t\t$field.addClass('product-image-admin-field');\n\t\t$field.addClass('product-image-enabled');\n\t\tif ( imageChoicesAdmin.hasProductImage(field) ) {\n\t\t\t$field.addClass('has-product-image');\n\t\t}\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\timageChoicesAdmin.initImageChoicesField = function(field) {\n\t\tvar $field = $('#field_'+field.id);\n\t\t$field.addClass('image-choices-admin-field');\n\t\t$field.addClass('image-choices-enabled');\n\t\tif ( imageChoicesAdmin.hasImageChoicesImage(field) ) {\n\t\t\t$field.addClass('image-choices-has-image');\n\t\t}\n\t\timageChoicesAdmin.updateFieldPreview(field);\n\t};\n\n\n\tvar skipImageChoicesFieldAlert = ( imageChoicesVars.skipImageChoicesFieldAlert.toString() === '1' || imageChoicesVars.skipImageChoicesFieldAlert.toString() === 'true' );\n\n\timageChoicesAdmin.formEditorInit = function() {\n\n\t\tif ( parseFloat(imageChoicesVars.gf_version) >= 2.9 ) {\n\n\t\t\t$(document).on( 'gform_field_added', function(event, form, field){\n\t\t\t\tif ( field.type === 'image_choice' && !skipImageChoicesFieldAlert ) {\n\t\t\t\t\timageChoicesAdmin.alert({\n\t\t\t\t\t\ttitle: \"Just checking...\",\n\t\t\t\t\t\tcontent: \"You've added Gravity Forms' native Image Choices field. This is different from JetSloth's Image Choices, which is a toggle on Radio Button and Checkbox fields.<br/><br/>Need help? <a href=\\\"https://jetsloth.com/articles/image-choices/native-image-choices-in-gravity-forms-2-9-vs-jetsloths-premium-add-on-a-comparison/\\\" target=\\\"_blank\\\">Learn more</a>.<br/><br/><label><input type=\\\"checkbox\\\" name=\\\"gfic_skip_image_choices_field_alert\\\" id=\\\"gfic_skip_image_choices_field_alert\\\" value=\\\"1\\\"><span>Don't show this again.</span></label>\",\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$('body').on('change', 'input#gfic_skip_image_choices_field_alert', function(e){\n\t\t\t\tskipImageChoicesFieldAlert = document.getElementById('gfic_skip_image_choices_field_alert').checked;\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: window.ajaxurl,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'gf_image_choices_skip_image_choices_field_alert',\n\t\t\t\t\t\tskip: skipImageChoicesFieldAlert,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tgform.addAction( 'gform_after_refresh_field_preview', function(fieldId){\n\t\t\tvar field = GetSelectedField();\n\t\t\tif ( imageChoicesAdmin.isImageChoicesEnabled(field) ) {\n\t\t\t\timageChoicesAdmin.updateFieldPreview(field);\n\t\t\t}\n\t\t});\n\n\t\t// setup previews on load\n\t\tform.fields.forEach(function(f){\n\t\t\tif ( imageChoicesAdmin.isProductImageEnabled(f) ) {\n\t\t\t\timageChoicesAdmin.initProductImageField(f);\n\t\t\t}\n\t\t\telse if ( imageChoicesAdmin.isImageChoicesEnabled(f) ) {\n\t\t\t\timageChoicesAdmin.initImageChoicesField(f);\n\t\t\t}\n\t\t});\n\n\t\t$('.gfield.image-choices-admin-field').each(function(){\n\t\t\timageChoicesAdmin.$fieldChoices( $(this) ).each(function(){\n\t\t\t\tlet $choice = $(this);\n\t\t\t\tif ( !$choice.hasClass('gchoice_total') ) {\n\t\t\t\t\t$choice.addClass('image-choices-choice');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t$('#gform_fields .gfield .ginput_container').each(function(){\n\t\t\timageChoicesAdmin.previewHeight( $(this) );\n\t\t});\n\n\n\t\t$(window).on('gf_update_field_choices', function() {\n\t\t\tsetTimeout(function() {\n\t\t\t\timageChoicesAdmin.getChoices();\n\t\t\t}, 10);\n\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t\t$(document).on('click', '.gf_insert_field_choice, .gf_delete_field_choice', function(e){\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t\tgform.addAction('gform_load_field_choices', function( fields ){\n\n\t\t\tsetTimeout(function(){\n\n\t\t\t\tvar field = ( typeof fields !== 'undefined' && fields.length ) ? fields[0] : GetSelectedField();\n\t\t\t\tvar $field = $('#field_'+field.id);\n\t\t\t\tvar $fieldSettings = imageChoicesAdmin.getSettingsElement();\n\n\t\t\t\tif ( imageChoicesAdmin.isProductImageField(field) ) {\n\n\t\t\t\t\t$('#field_base_price').on('change', imageChoicesAdmin.onProductPriceChange);\n\n\t\t\t\t\tvar productImageEnabled = imageChoicesAdmin.isProductImageEnabled(field);\n\n\t\t\t\t\tvar productImageUrl = (field.productImage_image !== undefined) ? field.productImage_image : '';\n\t\t\t\t\tvar productImageId = (field.productImage_imageId !== undefined) ? field.productImage_imageId : '';\n\t\t\t\t\tvar useProductImageLightbox = (field.productImage_useLightbox !== undefined) ? field.productImage_useLightbox : false;\n\t\t\t\t\tvar selectedProductImageTheme = (field.productImage_theme !== undefined) ? field.productImage_theme : 'form_setting';\n\t\t\t\t\tvar productImageStyle = (field.productImage_imageStyle !== undefined) ? field.productImage_imageStyle : 'form_setting';\n\t\t\t\t\tvar productImageUseLightboxCaption = (field.productImage_useLightboxCaption !== undefined) ? field.productImage_useLightboxCaption : true;\n\t\t\t\t\tif ( productImageUseLightboxCaption === \"form_setting\" || productImageUseLightboxCaption === \"\" ) {\n\t\t\t\t\t\tproductImageUseLightboxCaption = true;\n\t\t\t\t\t}\n\t\t\t\t\tvar productImageHeightSetting = (field.productImage_height !== undefined) ? field.productImage_height : '';\n\t\t\t\t\tvar productImageMediumHeightSetting = (field.productImage_heightMedium !== undefined) ? field.productImage_heightMedium : '';\n\t\t\t\t\tvar productImageSmallHeightSetting = (field.productImage_heightSmall !== undefined) ? field.productImage_heightSmall : '';\n\n\t\t\t\t\tvar productImageEntryValue = (field.productImage_entrySetting !== undefined) ? field.productImage_entrySetting : 'form_setting';\n\n\t\t\t\t\t$fieldSettings.addClass('product-image-field-settings');\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(productImageEnabled, true);\n\n\t\t\t\t\timageChoicesAdmin.updateProductImage(productImageUrl, productImageId);\n\n\t\t\t\t\timageChoicesAdmin.toggleUseLightbox(useProductImageLightbox, true);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(productImageUseLightboxCaption, true);\n\n\t\t\t\t\timageChoicesAdmin.updateThemeSetting(selectedProductImageTheme, true);\n\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting(productImageStyle, true);\n\n\t\t\t\t\timageChoicesAdmin.updateHeightSetting(productImageHeightSetting, true);\n\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting(productImageMediumHeightSetting, true);\n\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting(productImageSmallHeightSetting, true);\n\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting(productImageEntryValue, true);\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(false, true);\n\t\t\t\t\timageChoicesAdmin.updateProductImage('');\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(true, true);\n\t\t\t\t\timageChoicesAdmin.updateThemeSetting('form_setting', true);\n\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting('form_setting', true);\n\n\t\t\t\t\timageChoicesAdmin.updateHeightSetting('', true);\n\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting('', true);\n\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting('', true);\n\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting('', true);\n\n\t\t\t\t\t$field.removeClass('product-image-admin-field');\n\t\t\t\t\t$fieldSettings.removeClass('product-image-field-settings');\n\t\t\t\t}\n\n\t\t\t\tif ( imageChoicesAdmin.fieldCanHaveImages(field) ) {\n\n\t\t\t\t\tvar imagesEnabled = (field.imageChoices_enableImages === true);\n\t\t\t\t\tvar useLightbox = (field.imageChoices_useLightbox !== undefined) ? field.imageChoices_useLightbox : false;\n\t\t\t\t\tvar displayLabels = (field.imageChoices_showLabels !== undefined) ? field.imageChoices_showLabels : true;\n\t\t\t\t\tvar showPrices = (field.type === 'product' && field.imageChoices_showPrices !== undefined) ? field.imageChoices_showPrices : false;\n\t\t\t\t\tvar entryValue = (field.imageChoices_entrySetting !== undefined) ? field.imageChoices_entrySetting : 'form_setting';\n\t\t\t\t\tvar selectedTheme = (field.imageChoices_theme !== undefined) ? field.imageChoices_theme : 'form_setting';\n\t\t\t\t\tvar featureColor = (field.imageChoices_featureColor !== undefined) ? field.imageChoices_featureColor : 'form_setting';\n\t\t\t\t\tvar featureColorCustom = (field.imageChoices_featureColorCustom !== undefined) ? field.imageChoices_featureColorCustom : '';\n\t\t\t\t\tvar alignSetting = (field.imageChoices_align !== undefined) ? field.imageChoices_align : 'form_setting';\n\t\t\t\t\tvar imageStyle = (field.imageChoices_imageStyle !== undefined) ? field.imageChoices_imageStyle : 'form_setting';\n\t\t\t\t\tvar columnsSetting = (field.imageChoices_columns !== undefined) ? field.imageChoices_columns : 'form_setting';\n\t\t\t\t\tvar columnsWidthSetting = (field.imageChoices_columnsWidth !== undefined) ? field.imageChoices_columnsWidth : '';\n\t\t\t\t\tvar columnsMediumSetting = (field.imageChoices_columnsMedium !== undefined) ? field.imageChoices_columnsMedium : 'form_setting';\n\t\t\t\t\tvar columnsMediumWidthSetting = (field.imageChoices_columnsWidthMedium !== undefined) ? field.imageChoices_columnsWidthMedium : '';\n\t\t\t\t\tvar columnsSmallSetting = (field.imageChoices_columnsSmall !== undefined) ? field.imageChoices_columnsSmall : 'form_setting';\n\t\t\t\t\tvar columnsSmallWidthSetting = (field.imageChoices_columnsWidthSmall !== undefined) ? field.imageChoices_columnsWidthSmall : '';\n\t\t\t\t\tvar useLightboxCaption = (field.imageChoices_useLightboxCaption !== undefined) ? field.imageChoices_useLightboxCaption : true;\n\t\t\t\t\tif ( useLightboxCaption === \"form_setting\" || useLightboxCaption === \"\" ) {\n\t\t\t\t\t\tuseLightboxCaption = true;\n\t\t\t\t\t}\n\t\t\t\t\tvar heightSetting = (field.imageChoices_height !== undefined) ? field.imageChoices_height : '';\n\t\t\t\t\tvar mediumHeightSetting = (field.imageChoices_heightMedium !== undefined) ? field.imageChoices_heightMedium : '';\n\t\t\t\t\tvar smallHeightSetting = (field.imageChoices_heightSmall !== undefined) ? field.imageChoices_heightSmall : '';\n\n\t\t\t\t\t$fieldSettings.addClass('image-choices-field-settings');\n\n\t\t\t\t\tif ( field.type === 'product' ) {\n\t\t\t\t\t\t$fieldSettings.addClass('image-choices-product-field');\n\t\t\t\t\t}\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(imagesEnabled);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightbox(useLightbox);\n\t\t\t\t\timageChoicesAdmin.toggleShowLabels(displayLabels);\n\t\t\t\t\timageChoicesAdmin.toggleShowPrices(showPrices);\n\t\t\t\t\timageChoicesAdmin.updateEntrySetting(entryValue);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(useLightboxCaption);\n\n\t\t\t\t\tif ( !imageChoicesAdmin.isLegacyMode() ) {\n\t\t\t\t\t\timageChoicesAdmin.updateThemeSetting(selectedTheme);\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor(featureColorCustom);\n\t\t\t\t\t\timageChoicesAdmin.updateFeatureColorSetting(featureColor);\n\t\t\t\t\t\timageChoicesAdmin.updateAlignSetting(alignSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting(imageStyle);\n\n\t\t\t\t\t\timageChoicesAdmin.updateHeightSetting(heightSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting(mediumHeightSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting(smallHeightSetting);\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsWidthSetting(columnsWidthSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumWidthSetting(columnsMediumWidthSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallWidthSetting(columnsSmallWidthSetting);\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSetting(columnsSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumSetting(columnsMediumSetting);\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallSetting(columnsSmallSetting);\n\t\t\t\t\t}\n\n\t\t\t\t\timageChoicesAdmin.getChoices( field );\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\timageChoicesAdmin.toggleEnableImages(false);\n\t\t\t\t\timageChoicesAdmin.toggleUseLightboxCaption(true);\n\t\t\t\t\t//imageChoicesAdmin.toggleShowLabels(false);\n\n\t\t\t\t\tif ( !imageChoicesAdmin.isLegacyMode() ) {\n\t\t\t\t\t\timageChoicesAdmin.updateThemeSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateCustomFeatureColor('');\n\t\t\t\t\t\timageChoicesAdmin.updateFeatureColorSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateAlignSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateImageStyleSetting('form_setting');\n\n\t\t\t\t\t\timageChoicesAdmin.updateHeightSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateMediumHeightSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateSmallHeightSetting('');\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsWidthSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumWidthSetting('');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallWidthSetting('');\n\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsMediumSetting('form_setting');\n\t\t\t\t\t\timageChoicesAdmin.updateColumnsSmallSetting('form_setting');\n\t\t\t\t\t}\n\n\t\t\t\t\t$field.removeClass('image-choices-show-labels');\n\t\t\t\t\t$fieldSettings.removeClass('image-choices-field-settings');\n\t\t\t\t\t$fieldSettings.remove('image-choices-product-field');\n\t\t\t\t}\n\n\t\t\t}, 100);\n\n\t\t});\n\n\t\t$(document).bind('gform_load_field_settings', function (event, field, form) {\n\n\t\t\t// There's currently no action or event fired by GF when the 'show values' or 'show prices' option is toggled, but the preview updates\n\t\t\t// So we override the global UpdateFieldChoices that is called at this point (GF form_editor.js) in order to fire our own gf_update_field_choices event so we can update preview\n\t\t\tif (typeof window.imageChoices_GF_UpdateFieldChoices !== 'function' && typeof UpdateFieldChoices === 'function') {\n\t\t\t\twindow.imageChoices_GF_UpdateFieldChoices = UpdateFieldChoices;\n\t\t\t\twindow.UpdateFieldChoices = function() {\n\t\t\t\t\twindow.imageChoices_GF_UpdateFieldChoices.apply(this, arguments);\n\t\t\t\t\t$(window).trigger('gf_update_field_choices');\n\t\t\t\t};\n\t\t\t}\n\n\t\t\timageChoicesAdmin.previewHeight();\n\t\t});\n\n\t};\n\n\timageChoicesAdmin.formEditorLegacyWarning = function() {\n\n\t\treturn;\n\n\t\tvar alertMessage = [\n\t\t\t'<div class=\"gform-alert\" data-js=\"gform-alert\" role=\"status\" data-gform-alert-instance=\"gfic-legacy-alert-' + window.form.id.toString() + '\">',\n\t\t\t\t'<span class=\"gform-alert__icon gform-icon gform-icon--warning\" aria-hidden=\"true\"></span>',\n\t\t\t\t'<div class=\"gform-alert__message-wrap\">',\n\t\t\t\t\t'<p class=\"gform-alert__message\">JetSloth will stop supporting legacy markup at the end of 2023. We encourage you to test out your form with legacy markup turned off, to ensure continued compatibility with Image Choices.</p>',\n\t\t\t\t\t'<a class=\"gform-alert__cta gform-button gform-button--white gform-button--size-xs\" href=\"' + window.imageChoicesVars.form_settings + window.form.id.toString() + '#gform_setting_markupVersion\" aria-label=\"\">Form settings</a>',\n\t\t\t\t'</div>',\n\t\t\t'</div>',\n\t\t].join('');\n\n\t\tvar $gfLegacyAlert = $('.simplebar-content > .gform-alert[data-gform-alert-instance^=\"gform-alert-\"]:first');\n\t\tif ( $gfLegacyAlert.length ) {\n\t\t\t$gfLegacyAlert.after(alertMessage);\n\t\t}\n\t\telse {\n\t\t\t$('.simplebar-content').prepend(alertMessage);\n\t\t}\n\t\tgform.tools.trigger( 'gform_init_alerts' );\n\n\t};\n\n\timageChoicesAdmin.adminInit = () => {\n\n\t\t// Custom CSS editors\n\t\tvar $customCssBoxes = $('#gf_image_choices_custom_css_global, #gf_image_choices_custom_css, #gf_image_choices_user_css_global, #gf_image_choices_user_css_form');\n\t\tif ( $customCssBoxes.length ) {\n\t\t\tvar editorSettings = wp.codeEditor.defaultSettings ? _.clone( wp.codeEditor.defaultSettings ) : {};\n\t\t\teditorSettings.codemirror = _.extend(\n\t\t\t\t{},\n\t\t\t\teditorSettings.codemirror,\n\t\t\t\t{\n\t\t\t\t\tindentUnit: 4,\n\t\t\t\t\ttabSize: 4,\n\t\t\t\t\tmode: 'css',\n\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\tautoCloseBrackets: true,\n\t\t\t\t\tcontinueComments: true,\n\t\t\t\t\tindentWithTabs: true,\n\t\t\t\t\tinputStyle: \"contenteditable\",\n\t\t\t\t\tlineWrapping: true,\n\t\t\t\t\tlint: false,\n\t\t\t\t\tmatchBrackets: true,\n\t\t\t\t\tstyleActiveLine: true,\n\t\t\t\t\tgutters: [],\n\t\t\t\t\textraKeys: {\n\t\t\t\t\t\t\"Alt-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Cmd-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Ctrl-F\": \"findPersistent\",\n\t\t\t\t\t\t\"Cmd-/\": \"toggleComment\",\n\t\t\t\t\t\t\"Ctrl-/\": \"toggleComment\",\n\t\t\t\t\t\t\"Ctrl-Space\": \"autocomplete\",\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t\t$customCssBoxes.each(function(){\n\t\t\t\twindow[this.id + '_editor'] = wp.codeEditor.initialize( $(this), editorSettings );\n\t\t\t});\n\t\t}\n\n\t\tvar $legacyCssSectionToggle = $('#gform_settings_section_collapsed_gf_image_choices_legacy_custom_css_section, #gform_settings_section_collapsed_gf_image_choices_legacy_custom_form_css_section');\n\t\tif ( $legacyCssSectionToggle.length ) {\n\t\t\t$legacyCssSectionToggle.on('click', function(){\n\t\t\t\t$(this).closest('.gform-settings-panel').find('textarea').each(function(){\n\t\t\t\t\tvar ref = $(this).attr('id') + '_editor';\n\t\t\t\t\ttry {\n\t\t\t\t\t\twindow[ref].codemirror.refresh();\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\t// do nothing\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\n\t\t// show/hide new settings based on toggle\n\t\tvar $legacyModeToggle = $('#_gform_setting_gf_image_choices_use_legacy_styles');\n\t\tvar $newFeaturesElements = $('#gform-settings-section-theme, #gform-settings-section-feature-color, #gform-settings-section-choices-layout, #gform-settings-section-image-options, #gform-settings-section-custom-css, #gform-settings-section-gf_image_choices_legacy_custom_css_section .gform-settings-label');\n\n\t\tif ( $legacyModeToggle.length ) {\n\t\t\t$legacyModeToggle.on('change', function(e){\n\t\t\t\tvar useLegacyMode = $legacyModeToggle.is(':checked');\n\t\t\t\tif ( $newFeaturesElements.length ) {\n\t\t\t\t\t$newFeaturesElements.toggle( !useLegacyMode );\n\t\t\t\t}\n\t\t\t\tif ( $legacyCssSectionToggle.length ) {\n\t\t\t\t\tif ( ( useLegacyMode && $legacyCssSectionToggle.is(\":checked\") ) || ( !useLegacyMode && !$legacyCssSectionToggle.is(\":checked\") ) ) {\n\t\t\t\t\t\t$legacyCssSectionToggle.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t$legacyModeToggle.trigger('change');\n\t\t}\n\n\n\n\t\t// settings page tab switch (hide submit if not settings tab)\n\t\tvar $settingsTabNavLinks = $('#tab_gf-image-choices .gform-settings-tabs__navigation a');\n\t\tif ( $settingsTabNavLinks.length ) {\n\t\t\t$settingsTabNavLinks.each(function(){\n\t\t\t\t$(this).on('click', function(e){\n\t\t\t\t\twindow.location.hash = e.currentTarget.id.replace('gform-settings-tab-gf_image_choices_', '');\n\t\t\t\t\t$('#tab_gf-image-choices #gform-settings-save').toggle( $(this).data('tab') === \"gf_image_choices_settings_tab\" );\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst hash = window.location.hash.substring(1);\n\t\t\t\tconst hashTab = ( hash !== \"\" ) ? document.querySelector(`#tab_gf-image-choices #gform-settings-tab-gf_image_choices_${hash}`) : null;\n\t\t\t\tconst tabLink = hashTab ? hashTab : $settingsTabNavLinks[0];\n\t\t\t\ttabLink.dispatchEvent( new Event('click') );\n\t\t\t}, 100);\n\t\t}\n\n\n\t\t// numeric settings live validation to number (plugin and form settings)\n\t\tvar $numericSettingsInputs = $('input[id^=\"gf_image_choices\"][id*=\"columns_width\"], input[id^=\"image-choices\"][id*=\"columns-width\"], input[id^=\"gf_image_choices\"][id*=\"height\"], input[id^=\"image-choices\"][id*=\"height\"], input[id^=\"product-image\"][id*=\"height\"]');\n\t\tif ( $numericSettingsInputs.length ) {\n\t\t\t$numericSettingsInputs.each(function(){\n\t\t\t\tvar $input = $(this);\n\t\t\t\t$input.on('keyup', function(e){\n\t\t\t\t\tvar val = e.currentTarget.value.toString();\n\t\t\t\t\tvar numVal = imageChoicesAdmin.validateNumericValue( val );\n\t\t\t\t\tif ( numVal !== val ) {\n\t\t\t\t\t\te.currentTarget.value = numVal;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\n\t\t// form settings theme preview\n\t\tvar $settingsThemeSelect = $('#gf_image_choices_theme, #gf_image_choices_global_theme').first();\n\t\tvar $settingsThemePreview = $('#gform_setting_gf_image_choices_theme_preview .image-choices-theme-preview, #gform_setting_gf_image_choices_global_theme_preview .image-choices-theme-preview').first();\n\t\tif ( $settingsThemeSelect.length && $settingsThemePreview.length ) {\n\t\t\t$settingsThemeSelect.on('change', function(e){\n\t\t\t\tvar value = $(this).val();\n\t\t\t\tif ( value === \"\" || value == \"global_setting\" ) {\n\t\t\t\t\tvalue = ( imageChoicesVars.hasOwnProperty('globals') && imageChoicesVars.globals.hasOwnProperty('theme') ) ? imageChoicesVars.globals.theme : ( imageChoicesVars.hasOwnProperty('defaults') && imageChoicesVars.defaults.hasOwnProperty('theme') ) ? imageChoicesVars.defaults.theme : 'simple';\n\t\t\t\t}\n\n\t\t\t\t$settingsThemePreview.toggle(value !== 'none');\n\t\t\t\tif (value === 'none') {\n\t\t\t\t\t$settingsThemePreview.hide().find('img').hide();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$settingsThemePreview.find('img').hide();\n\t\t\t\t\t$settingsThemePreview.find('img.image-choices-theme-preview-'+value).show();\n\t\t\t\t}\n\t\t\t});\n\t\t\t$settingsThemeSelect.trigger('change');\n\t\t}\n\n\t\t// form settings feature color\n\t\tvar $settingsFeatureColorSelect = $('#gf_image_choices_feature_color, #gf_image_choices_global_feature_color').first();\n\t\tvar $settingsFeatureColorCustom = $('#gform_setting_gf_image_choices_feature_color_custom, #gform_setting_gf_image_choices_global_feature_color_custom').first();\n\t\tvar $settingsFeatureColorInput = $('#gf_image_choices_feature_color_custom, #gf_image_choices_global_feature_color_custom').first();\n\t\tvar settingsCustomFeatureColor;\n\t\tvar $settingsFeatureColorPicker;\n\n\t\tif ( $settingsFeatureColorSelect.length && $settingsFeatureColorCustom.length ) {\n\n\t\t\t$settingsFeatureColorPicker = $settingsFeatureColorCustom.find('.wp-picker-container');\n\t\t\tsettingsCustomFeatureColor = $settingsFeatureColorInput.val();\n\n\t\t\t$settingsFeatureColorSelect.on('change', function(e){\n\t\t\t\tvar value = $(this).val();\n\n\t\t\t\tif ( value === \"custom\" ) {\n\t\t\t\t\t$settingsFeatureColorCustom.show();\n\t\t\t\t\tif ( $settingsFeatureColorPicker.length ) {\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif ( customColor !== \"\" ) {\n\t\t\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker('color', settingsCustomFeatureColor);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker();\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif ( settingsCustomFeatureColor !== \"\" ) {\n\t\t\t\t\t\t\t\t$settingsFeatureColorInput.wpColorPicker('color', settingsCustomFeatureColor);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$settingsFeatureColorCustom.hide();\n\t\t\t\t\tif ( $settingsFeatureColorPicker.length ) {\n\t\t\t\t\t\t$settingsFeatureColorPicker.find('.wp-picker-clear').trigger('click');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\t$settingsFeatureColorSelect.trigger('change');\n\t\t}\n\n\n\n\t\tvar $urlReplacementTool = $('#image_choices_url_replacement');\n\t\tvar $urlReplacementSubmit = ($urlReplacementTool.length) ? $('#image_choices_url_replacement_submit') : null;\n\t\tvar $urlReplacementProgress = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress') : null;\n\t\tvar $urlReplacementProgressBar = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress-percent') : null;\n\t\tvar $urlReplacementStatus = ($urlReplacementTool.length) ? $urlReplacementTool.find('.jetbase-tool__progress-status') : null;\n\n\t\tvar urlReplacements = {\n\t\t\told: \"\",\n\t\t\tnew: \"\",\n\t\t\tforms: [],\n\t\t\tindex: 0,\n\t\t\treplacements: []\n\t\t}\n\n\t\timageChoicesAdmin.processUrlReplacement = function() {\n\t\t\tif ( !urlReplacements.forms.length || urlReplacements.replacements.length === urlReplacements.forms.length || urlReplacements.index >= urlReplacements.forms.length ) {\n\t\t\t\t// done\n\t\t\t\t$urlReplacementProgressBar.css('width', `100%`);\n\t\t\t\t$urlReplacementStatus.html(`Done! ${urlReplacements.forms.length} form(s) processed`);\n\t\t\t\t$urlReplacementTool.removeClass('busy');\n\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t$sizeReplacementTool.removeClass('disabled');\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: window.ajaxurl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'gf_image_choices_url_replacement',\n\t\t\t\t\tid: urlReplacements.forms[urlReplacements.index],\n\t\t\t\t\told: urlReplacements.old,\n\t\t\t\t\tnew: urlReplacements.new\n\t\t\t\t},\n\t\t\t\tbeforeSend: function(jqXHR, settings){\n\t\t\t\t\t$urlReplacementStatus.html(`Processing form ${urlReplacements.index + 1}/${urlReplacements.forms.length}`);\n\t\t\t\t},\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = response.total;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = false;\n\t\t\t\t\t\t$urlReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\turlReplacements.replacements[urlReplacements.index] = false;\n\t\t\t\t\t\t$urlReplacementStatus.html('Error');\n\t\t\t\t\t}\n\t\t\t\t\turlReplacements.index++;\n\t\t\t\t\t$urlReplacementProgressBar.css('width', `${ Math.ceil( (urlReplacements.index / urlReplacements.forms.length) * 100 ) }%`);\n\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t\tif ( $urlReplacementSubmit && $urlReplacementSubmit.length ) {\n\n\t\t\t$urlReplacementSubmit.on('click', function(e){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar formId = $urlReplacementTool.find('#image_choices_url_replacement_form_select').val().trim();\n\t\t\t\tvar oldUrl = $urlReplacementTool.find('#image_choices_url_replacement_from_input').val().trim();\n\t\t\t\tvar newUrl = $urlReplacementTool.find('#image_choices_url_replacement_to_input').val().trim();\n\t\t\t\tif ( !oldUrl || !newUrl || oldUrl === newUrl ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\turlReplacements.old = oldUrl;\n\t\t\t\turlReplacements.new = newUrl;\n\t\t\t\turlReplacements.forms = [];\n\t\t\t\turlReplacements.index = 0;\n\t\t\t\turlReplacements.replacements = [];\n\n\t\t\t\tif ( formId === \"all\" ) {\n\n\t\t\t\t\t$urlReplacementStatus.html('Scanning for forms with old URL in image choices...');\n\t\t\t\t\t$urlReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$urlReplacementTool.addClass('busy');\n\t\t\t\t\t$urlReplacementProgress.addClass('active');\n\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t$sizeReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: window.ajaxurl,\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'gf_image_choices_get_url_replacement_form_ids',\n\t\t\t\t\t\t\tform_id: urlReplacements.formId,\n\t\t\t\t\t\t\told: urlReplacements.old,\n\t\t\t\t\t\t\tnew: urlReplacements.new\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\tif ( response.forms && response.forms.length ) {\n\t\t\t\t\t\t\t\t\turlReplacements.forms = response.forms\n\t\t\t\t\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t$urlReplacementProgressBar.css('width', `100%`);\n\t\t\t\t\t\t\t\t\t$urlReplacementStatus.html(`Done! No image choices found containing that old URL`);\n\t\t\t\t\t\t\t\t\t$urlReplacementTool.removeClass('busy');\n\t\t\t\t\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t\t\t\t\t$sizeReplacementTool.removeClass('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\t\t\t$urlReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$urlReplacementStatus.html('Error');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\t$urlReplacementStatus.html('...');\n\t\t\t\t\t$urlReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$urlReplacementTool.addClass('busy');\n\t\t\t\t\t$urlReplacementProgress.addClass('active');\n\t\t\t\t\tif ( $sizeReplacementTool.length ) {\n\t\t\t\t\t\t$sizeReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\turlReplacements.forms = [ formId ]\n\t\t\t\t\timageChoicesAdmin.processUrlReplacement();\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t}\n\n\n\t\tvar $sizeReplacementTool = $('#image_choices_image_replacement');\n\t\tvar $sizeReplacementSubmit = ($sizeReplacementTool.length) ? $('#image_choices_image_replacement_submit') : null;\n\t\tvar $sizeReplacementProgress = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress') : null;\n\t\tvar $sizeReplacementProgressBar = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress-percent') : null;\n\t\tvar $sizeReplacementStatus = ($sizeReplacementTool.length) ? $sizeReplacementTool.find('.jetbase-tool__progress-status') : null;\n\n\t\tvar sizeReplacements = {\n\t\t\tnew: \"\",\n\t\t\tforms: [],\n\t\t\tindex: 0,\n\t\t\treplacements: []\n\t\t}\n\n\t\timageChoicesAdmin.processSizeReplacement = function() {\n\t\t\tif ( !sizeReplacements.forms.length || sizeReplacements.replacements.length === sizeReplacements.forms.length || sizeReplacements.index >= sizeReplacements.forms.length ) {\n\t\t\t\t// done\n\t\t\t\t$sizeReplacementProgressBar.css('width', `100%`);\n\t\t\t\t$sizeReplacementStatus.html(`Done! ${sizeReplacements.forms.length} form(s) processed`);\n\t\t\t\t$sizeReplacementTool.removeClass('busy');\n\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t$urlReplacementTool.removeClass('disabled');\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: window.ajaxurl,\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'gf_image_choices_image_size_replacement',\n\t\t\t\t\tid: sizeReplacements.forms[sizeReplacements.index],\n\t\t\t\t\tnew: sizeReplacements.new\n\t\t\t\t},\n\t\t\t\tbeforeSend: function(jqXHR, settings) {\n\t\t\t\t\t$sizeReplacementStatus.html(`Processing form ${sizeReplacements.index + 1}/${sizeReplacements.forms.length}`);\n\t\t\t\t},\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = response.total;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = false;\n\t\t\t\t\t\t$sizeReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tsizeReplacements.replacements[sizeReplacements.index] = false;\n\t\t\t\t\t\t$sizeReplacementStatus.html('Error');\n\t\t\t\t\t}\n\t\t\t\t\tsizeReplacements.index++;\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', `${ Math.ceil( (sizeReplacements.index / sizeReplacements.forms.length) * 100 ) }%`);\n\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t\tif ( $sizeReplacementSubmit && $sizeReplacementSubmit.length ) {\n\n\t\t\t$sizeReplacementSubmit.on('click', function(e){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar newSize = $sizeReplacementTool.find('#image_choices_image_replacement_size_select').val().trim();\n\t\t\t\tvar formId = $sizeReplacementTool.find('#image_choices_image_replacement_form_select').val().trim();\n\t\t\t\tif ( !newSize ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsizeReplacements.new = newSize;\n\t\t\t\tsizeReplacements.forms = [];\n\t\t\t\tsizeReplacements.index = 0;\n\t\t\t\tsizeReplacements.replacements = [];\n\n\n\t\t\t\tif ( formId === \"all\" ) {\n\n\t\t\t\t\t$sizeReplacementStatus.html('Scanning for forms with image choices enabled...');\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$sizeReplacementTool.addClass('busy');\n\t\t\t\t\t$sizeReplacementProgress.addClass('active');\n\n\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t$urlReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: window.ajaxurl,\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'gf_image_choices_get_image_size_replacement_form_ids',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif ( response && response.success ) {\n\t\t\t\t\t\t\t\tif ( response.forms && response.forms.length ) {\n\t\t\t\t\t\t\t\t\tsizeReplacements.forms = response.forms\n\t\t\t\t\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t$sizeReplacementProgressBar.css('width', `100%`);\n\t\t\t\t\t\t\t\t\t$sizeReplacementStatus.html(`Done! No forms found with image choices enabled`);\n\t\t\t\t\t\t\t\t\t$sizeReplacementTool.removeClass('busy');\n\t\t\t\t\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t\t\t\t\t$urlReplacementTool.removeClass('disabled');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if ( response && response.error ) {\n\t\t\t\t\t\t\t\t$sizeReplacementStatus.html('Error: ' + response.error );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t$sizeReplacementStatus.html('Error');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\t$sizeReplacementStatus.html('...');\n\t\t\t\t\t$sizeReplacementProgressBar.css('width', '0%');\n\t\t\t\t\t$sizeReplacementTool.addClass('busy');\n\t\t\t\t\t$sizeReplacementProgress.addClass('active');\n\n\t\t\t\t\tif ( $urlReplacementTool.length ) {\n\t\t\t\t\t\t$urlReplacementTool.addClass('disabled');\n\t\t\t\t\t}\n\n\t\t\t\t\tsizeReplacements.forms = [ formId ];\n\t\t\t\t\timageChoicesAdmin.processSizeReplacement();\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t}\n\n\t};\n\n\tvar gformAdminReady = false;\n\tvar gformAdminReadyCheck;\n\n\t$(document).ready(function() {\n\t\tif ( !gformAdminReady ) {\n\t\t\tgformAdminReadyCheck = setInterval(function(){\n\t\t\t\tif ( typeof gform !== 'undefined' ) {\n\t\t\t\t\tgformAdminReady = true;\n\t\t\t\t\tclearInterval(gformAdminReadyCheck);\n\t\t\t\t\timageChoicesAdmin.adminInit();\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t}\n\t});\n\n\t$(document).bind( 'gform_main_scripts_loaded', function() {\n\n\t\tif ( typeof window.form !== 'undefined' ) {\n\t\t\tvar markupVersion = imageChoicesAdmin.markupDetect();\n\t\t\tif ( markupVersion === 1 && imageChoicesAdmin.formHasImageChoicesFields() ) {\n\t\t\t\timageChoicesAdmin.formEditorLegacyWarning();\n\t\t\t}\n\t\t\timageChoicesAdmin.formEditorInit();\n\t\t}\n\n\t});\n\n})(jQuery);\n"],"mappings":"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"}